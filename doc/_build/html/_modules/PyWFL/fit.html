

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PyWFL.fit &mdash; PyWFL 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="PyWFL 1.0 documentation" href="../../index.html"/>
        <link rel="up" title="PyWFL" href="../PyWFL.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> PyWFL
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">PyWFL</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">PyWFL</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
          <li><a href="../PyWFL.html">PyWFL</a> &raquo;</li>
      
    <li>PyWFL.fit</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for PyWFL.fit</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">_fit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<div class="viewcode-block" id="fit"><a class="viewcode-back" href="../../PyWFL.fit.html#PyWFL.fit.fit">[docs]</a><span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Give a linear fit of a time series by minimizing chi-square method.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array): The time index of array y</span>
<span class="sd">        y (array): Time series to be fitted (:math:`y=a+bx`)</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple:</span>
<span class="sd">            * a (float): constant term for :math:`y=a+bx`</span>
<span class="sd">            * b (float): linear (or velocity) term for :math:`y=a+bx`</span>
<span class="sd">            * sig_a (float): Respective probable uncertainties of constant term a.  (Note: Formal error, unrealistic)</span>
<span class="sd">            * sig_b (float): Respective probable uncertainties of linear term b. (Note: Formal error, unrealistic)</span>

<span class="sd">    Notes:</span>
<span class="sd">        Given a set of data points x(1:n),y(1:n), fit them to a straight line y = a + bx by minimizing chi-square. Returned are a,b and their respective probable uncertainties siga and sigb.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; a = np.arange(10)</span>
<span class="sd">        &gt;&gt;&gt; b = 1.2 * a + 3.0 + np.random.rand(10)</span>
<span class="sd">        &gt;&gt;&gt; fa, fb, sig_a, sig_b = fit(a, b)</span>

<span class="sd">&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_fit</span><span class="o">.</span><span class="n">py_fitline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="fitmulti"><a class="viewcode-back" href="../../PyWFL.fit.html#PyWFL.fit.fitmulti">[docs]</a><span class="k">def</span> <span class="nf">fitmulti</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Do multiple linear regression by minimizing chi-square method (or least squares method).</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array) : x[n, m-1] The multi-variables value (n point, and m-1 variables)</span>
<span class="sd">        y (array) : The function value :math:`y(i)=a0+a1*x1(i)+a2*x2(i)+...+a(m-1)*x(m-1)(i)`, where :math:`i=1,n`</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>
<span class="sd">            * a (array) : a(m) Multiple linear regression coefficients of :math:`y(i)=a0+a1*x1(i)+a2*x2(i)+...+a(m-1)*x(m-1)(i)`</span>
<span class="sd">            * covar (matrix): covar(m, m) Covariance matrix (the diagonal is variance) of a</span>
<span class="sd">            * chisq (float): Mean standard deviation, see Notes for details</span>
<span class="sd">            * s (float): Mean standard deviation, see Notes for details</span>
<span class="sd">            * r (float): Coefficient of multiple correlation, see Notes for details</span>
<span class="sd">            * v (array): v(m) Partial correlation coefficient, see Notes for details</span>

<span class="sd">    Notes:</span>
<span class="sd">        Please careful to deal with the relation between regression coefficients and variable x. a(1) corresponding x0 (the constant term), a(2:m) corresponding to x(n, 1:m-1) variables, so covar and v. Also, v(1)=0.0 means no partial correlation coefficient (for constant term) was calculated from FITMULTI.</span>
<span class="sd">        The multiple linear regression model is:</span>

<span class="sd">        .. math:: y_i = \sum_{j=0}^{m} a_{ij}x_{ij} \qquad i = 1, 2, \dots n</span>

<span class="sd">        Residuals sum of squares is:</span>

<span class="sd">        .. math:: \chi^2 = \sum_{i=1}^{n} [ y_i - \sum_{j=0}^{m} a_{ij} x_{ij} ]</span>

<span class="sd">        Mean standard deviation is:</span>

<span class="sd">        .. math::</span>
<span class="sd">            s &amp; = &amp; \sqrt{1 - \chi^2 / dyy} \\\\</span>
<span class="sd">            dyy &amp; = &amp; \sum_{i=1}^{n} y_i - \bar{y} \\\\</span>
<span class="sd">            \bar{y} &amp; = &amp; \sum_{i=1}^{n} y_i / n</span>

<span class="sd">        Partial correlation coefficient is:</span>

<span class="sd">        .. math::</span>
<span class="sd">            v_j &amp; = &amp; \sqrt{1 - \chi^2 / Q_j} \\\\</span>
<span class="sd">            Q_j &amp; = &amp; \sum_{i=1}^{n}[ y_i - \sum_{k=1, k \neq j}^{m}a_{ik}x_{ik} ]</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; a = np.arange(10)</span>
<span class="sd">        &gt;&gt;&gt; b = 1.2 * a + 3.0 + np.random.rand(10)</span>
<span class="sd">        &gt;&gt;&gt; fitmulti(a, b)</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_fit</span><span class="o">.</span><span class="n">py_fitmulti</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="fitpoly"><a class="viewcode-back" href="../../PyWFL.fit.html#PyWFL.fit.fitpoly">[docs]</a><span class="k">def</span> <span class="nf">fitpoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Give a polynomial fit of a time series by minimizing chi-square method.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array): The self-variable of fitted polynomial function</span>
<span class="sd">        y (array): Time series to be fitted ( y=f(x) )</span>
<span class="sd">        order (int) : default 2, The maximum degree of polynomial (you can use FITPOLY_BEST_DEGREE to get the best degree of polynomial)</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>
<span class="sd">            * a (m): Polynomial term for :math:`y = a1+a2*x+a3*x**2+...am*x**(m-1)`. Note: After Dec. 19, 2014, the x in the formula should be substituted by x-x(1), see comments for details.</span>
<span class="sd">            * covar (m, m): Covariance matrix (the diagonal is variance) of a</span>
<span class="sd">            * chisq: :math:`\chi^2`,the postfit residual sums of squares. the postfit residual sums of squares.  chisq=sum [ (y(i)-y_fit(i)) **2 ]  ,i=1,...,n</span>

<span class="sd">    Notes:</span>
<span class="sd">        Given a set of data points x(1:n), y(1:n) , use chi-square minimization to fit for some or all of the coefficients a(1:m) of a function that depends linearly on a, y = a1+a2*x+a3*x**2+...,The program returns values for a(1:m), :math:`\chi^2` = chisq, and the covariance matrix covar(1:m,1:m).</span>

<span class="sd">        the input x(:) was changed to x(:)-x(1) in the subroutine FITPOLY on Dec. 19, 2014. To do this will prevent the problem in x(:) which may cause wrong output values of the subroutine. For example, if x(:) is index of year, i.e., 2000.001-2010.999 with daily interval, using the NON-modified FITPOLY will give wrong results, but the modified FITPOLY will give the correct results (the reason is that we will use x**n in the subroutine, if x value change is small, x**n will similar.). After this modification, to restore the polynomial data using output parameter a manually, you must change x(:) to x(:)-x(1). That is y=a0+a1*(x-x(1))+a2*(x-x(1))**2+... , or simply use subroutine POLYNOMIAL.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; a = np.arange(10)</span>
<span class="sd">        &gt;&gt;&gt; b = 1.2 * a + 3.0 + np.random.rand(10)</span>
<span class="sd">        &gt;&gt;&gt; fitpoly(a, b)</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">order</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">order</span> <span class="o">=</span> <span class="n">fitpoly_best_degree</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_fit</span><span class="o">.</span><span class="n">py_fitpoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span></div>


<div class="viewcode-block" id="fitpoly_best_degree"><a class="viewcode-back" href="../../PyWFL.fit.html#PyWFL.fit.fitpoly_best_degree">[docs]</a><span class="k">def</span> <span class="nf">fitpoly_best_degree</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">max_order</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bic&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Give the best fit degree (or order) of a polynomial fit for a time series by using minimizing chi-square method.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array) : The time index of array y</span>
<span class="sd">        y (array) : Time series to be fitted ( y=f(x) )</span>
<span class="sd">        n (int): The number of array x and y</span>
<span class="sd">        max_order (int) : The maximum degrees of polynomial fit, default 10</span>
<span class="sd">        method(string) : Method to get best fit order, default &#39;bic&#39; criterion; optional in [&#39;aic&#39;, &#39;bic&#39;]</span>

<span class="sd">    Returns:</span>
<span class="sd">        int : nbest_order, The best order for the polynomial fit</span>

<span class="sd">    Notes:</span>
<span class="sd">        Given a set of data points x(1:n), y(1:n) , use chi-square minimization to fit for some or all of the coefficients a(1:m) of a function that depends linearly on a, y = a1+a2*x+a3*x**2+...,then use AIC or BIC criterion to get the best fit order.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; a = np.arange(10)</span>
<span class="sd">        &gt;&gt;&gt; b = 1.2 * a + 3.0 + np.random.rand(10)</span>
<span class="sd">        &gt;&gt;&gt; fitpoly_best_degree(a, b, method=&#39;aic&#39;)</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="n">cond</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;aic&#39;</span><span class="p">,</span> <span class="s1">&#39;bic&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cond</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;cond should be in &quot;[</span><span class="si">%s</span><span class="s1">]&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cond</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">_fit</span><span class="o">.</span><span class="n">py_fitpoly_best_degree</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">max_order</span><span class="p">,</span> <span class="n">ch</span><span class="o">=</span><span class="n">method</span><span class="p">)</span></div>


<div class="viewcode-block" id="detrend"><a class="viewcode-back" href="../../PyWFL.fit.html#PyWFL.fit.detrend">[docs]</a><span class="k">def</span> <span class="nf">detrend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Detrend the linear term of a time series</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array): The time index of array y</span>
<span class="sd">        y (array): Array y, time series to be detrend</span>

<span class="sd">    Returns:</span>
<span class="sd">        array: yout, detrend time series</span>

<span class="sd">    Notes:</span>
<span class="sd">        Least squares fit</span>
<span class="sd">        Gives data x(n),y(n), get detrend data yout(n), the trend is fitted as y=a+bx</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; a = np.arange(10)</span>
<span class="sd">        &gt;&gt;&gt; b = 1.2 * a + 3.0 + np.random.rand(10)</span>
<span class="sd">        &gt;&gt;&gt; r = detrend(a, b)</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">return</span> <span class="n">_fit</span><span class="o">.</span><span class="n">py_detrend</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>


<span class="c1"># def harmonic(t, x, pe, itrend=2, timebegin=None, method=&#39;bic&#39;):</span>
<span class="c1">#     if timebegin is None:</span>
<span class="c1">#         timebegin = x[0]</span>
<span class="c1">#     if itrend &lt; 0:</span>
<span class="c1">#         return _fit.py_wfl_harmonic_polys(t, x, pe, timebegin=timebegin, method=method)</span>
<span class="c1">#     else:</span>
<span class="c1">#         return _fit.py_wfl_harmonic_fix(t, x, pe, itrend, timebegin=timebegin)</span>

<div class="viewcode-block" id="lsfit"><a class="viewcode-back" href="../../PyWFL.fit.html#PyWFL.fit.lsfit">[docs]</a><span class="k">def</span> <span class="nf">lsfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;General linear Least Squares(LS) fits</span>

<span class="sd">    Args:</span>
<span class="sd">        x (array) : x[n], The time series of self-variable of LS fit function, e.g. function :math:`f(x)`</span>
<span class="sd">        y (array) : y[n], Time series to be fitted ( :math:`y=f(x)` )</span>
<span class="sd">        m (int) : The number fitted coefficients</span>
<span class="sd">        func (function) : External function ( :math:`y=f(x)` ) to be fitted, func must be a subroutine to provide the fit function, it could be considered as the design matrix, this function returns ndarray result[m, n]</span>
<span class="sd">        sig (array) : sig[n], default None, means all weight are the same.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple</span>
<span class="sd">            * a (array) : a(m), LS fitted coefficients</span>
<span class="sd">            * cov (ndarray) : cov[m, m], Covariance matrix (the diagonal is variance) of a</span>
<span class="sd">            * chisq (float) : :math:`\chi^2`, the postfit residual sums of squares. :math:`\chi^2 = \sum ( y_i - f(x_i)  )^2, i=1,\dots,n`</span>

<span class="sd">    Notes:</span>
<span class="sd">        General Linear LS Fit by Gauss-Jordan Elimination.</span>

<span class="sd">        Given a set of data points x(1:n), y(1:n) , use chi-square minimization to fit all of the coefficients a(1:m) of a function that depends linearly on a, y = f(x),The program returns values for a(1:m), :math:`\chi^2`, and the covariance matrix covar(1:m,1:m).</span>

<span class="sd">        How to write user-defined function? the user-defined function can be regarded as design matrix, see the example</span>


<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # user define function f(x) = 1 + x + x^2</span>
<span class="sd">        &gt;&gt;&gt; # the result will return the left design matrix</span>
<span class="sd">        &gt;&gt;&gt; def fpoly(x, n):</span>
<span class="sd">        &gt;&gt;&gt;     res = np.ones((n, len(x)))</span>
<span class="sd">        &gt;&gt;&gt;     for i in range(1, n):</span>
<span class="sd">        &gt;&gt;&gt;         res[i, :] = res[i - 1, :] * x</span>
<span class="sd">        &gt;&gt;&gt;     return res</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; def func(x):</span>
<span class="sd">        &gt;&gt;&gt;     return 1 + x + x**2</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; x = np.arange(10) * 1.0</span>
<span class="sd">        &gt;&gt;&gt; y = func(x)</span>
<span class="sd">        &gt;&gt;&gt; print lsfit(x, y, 3, fpoly)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; with weight example</span>
<span class="sd">        &gt;&gt;&gt; yerr = np.random.rand(10)</span>
<span class="sd">        &gt;&gt;&gt; y += yerr</span>
<span class="sd">        &gt;&gt;&gt; print fpoly(x, 3).shape</span>
<span class="sd">        &gt;&gt;&gt; print lsfit(x, y, 3, fpoly, sig=yerr)</span>
<span class="sd">&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">sig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_fit</span><span class="o">.</span><span class="n">lsfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">sig</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_fit</span><span class="o">.</span><span class="n">lsfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span></div>


<div class="viewcode-block" id="fpoly"><a class="viewcode-back" href="../../PyWFL.fit.html#PyWFL.fit.fpoly">[docs]</a><span class="k">def</span> <span class="nf">fpoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">x</span>
    <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="func"><a class="viewcode-back" href="../../PyWFL.fit.html#PyWFL.fit.func">[docs]</a><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span></div>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span> <span class="n">lsfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">fpoly</span><span class="p">)</span>
    <span class="n">yerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="n">yerr</span>
    <span class="nb">print</span> <span class="n">fpoly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
    <span class="nb">print</span> <span class="n">lsfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">fpoly</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">yerr</span><span class="p">)</span>
    <span class="c1"># print _fit.py_wfl_harmonic_polys.__doc__</span>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, YAN Haoming, WU Dingcheng.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>