

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PyWFL.geophysics package &mdash; PyWFL 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="PyWFL 1.0 documentation" href="index.html"/>
        <link rel="up" title="PyWFL package" href="PyWFL.html"/>
        <link rel="next" title="PyWFL.harmonics package" href="PyWFL.harmonics.html"/>
        <link rel="prev" title="PyWFL.fit package" href="PyWFL.fit.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PyWFL
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">PyWFL</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="PyWFL.html">PyWFL package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="PyWFL.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="PyWFL.calendar.html">PyWFL.calendar package</a></li>
<li class="toctree-l4"><a class="reference internal" href="PyWFL.coordinate.html">PyWFL.coordinate package</a></li>
<li class="toctree-l4"><a class="reference internal" href="PyWFL.coorelation.html">PyWFL.coorelation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="PyWFL.filters.html">PyWFL.filters package</a></li>
<li class="toctree-l4"><a class="reference internal" href="PyWFL.fit.html">PyWFL.fit package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">PyWFL.geophysics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="PyWFL.harmonics.html">PyWFL.harmonics package</a></li>
<li class="toctree-l4"><a class="reference internal" href="PyWFL.rand.html">PyWFL.rand package</a></li>
<li class="toctree-l4"><a class="reference internal" href="PyWFL.spectrum.html">PyWFL.spectrum package</a></li>
<li class="toctree-l4"><a class="reference internal" href="PyWFL.statistics.html">PyWFL.statistics package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="PyWFL.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="PyWFL.html#module-PyWFL.constant">PyWFL.constant module</a></li>
<li class="toctree-l3"><a class="reference internal" href="PyWFL.html#module-PyWFL">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">PyWFL</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="modules.html">PyWFL</a> &raquo;</li>
      
          <li><a href="PyWFL.html">PyWFL package</a> &raquo;</li>
      
    <li>PyWFL.geophysics package</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/PyWFL.geophysics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pywfl-geophysics-package">
<h1>PyWFL.geophysics package<a class="headerlink" href="#pywfl-geophysics-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-PyWFL.geophysics">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-PyWFL.geophysics" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="PyWFL.geophysics.am2eam">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">am2eam</code><span class="sig-paren">(</span><em>am</em>, <em>cha='xp'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#am2eam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.am2eam" title="Permalink to this definition">¶</a></dt>
<dd><p>Change Angular Momentum (AM) to Effective Angular Momentum (EAM)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>am</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Angular Momentum (unit: <span class="math">\(kg.m^2/s\)</span>)</li>
<li><strong>cha</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; cha eaqual one of follow character, &#8216;xp&#8217;, &#8216;xc&#8217;, &#8216;yp&#8217;, &#8216;yc&#8217;, &#8216;zp&#8217;, &#8216;zc&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Effective Angular Momentum (unit: 1.0e-7 rad)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Notes:a</dt>
<dd><p class="first">cha denote x,y or z coordinate for pressure (p) and current (c) term
All the parameters about Earth is Eubank&#8217;s value like below:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cc</span>  <span class="o">=</span> <span class="mf">7.1236</span> <span class="c1">#earth principal moment of inertia</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccm</span> <span class="o">=</span> <span class="mf">7.1236</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ca</span>  <span class="o">=</span> <span class="mf">0.003664</span><span class="o">*</span><span class="n">cc</span>       <span class="c1">#c - a</span>
</pre></div>
</div>
<p>barnes&#8217;s earth parameter (not used here) :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cc</span><span class="o">=</span><span class="mf">7.04</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ccm</span><span class="o">=</span><span class="mf">7.1236</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ca</span><span class="o">=</span><span class="mf">0.00333</span><span class="o">*</span><span class="n">cc</span>
</pre></div>
</div>
<p class="last">this function only used in earth rotation domain, which change oceanic am to oceanic eam.</p>
</dd>
</dl>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Barnes R. T. H., Atmospheric angular momentum fluctuations, length of day changes and polar motion, Proc. R. Soc. Lond. A, 387,31-73, 1983.</td></tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">todo</p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.angle_dis">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">angle_dis</code><span class="sig-paren">(</span><em>fai1</em>, <em>lambda1</em>, <em>fai2</em>, <em>lambda2</em>, <em>ch='radian'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#angle_dis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.angle_dis" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate geocentric angle (or corresponding Earth&#8217;s surface distance) between two points</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lambda1</strong> (<em>fai1</em><em>,</em><em></em>) &#8211; First point&#8217;s coordinate (latitude, longitude) (unit: degree, -90~90, 0~360)</li>
<li><strong>lambda2</strong> (<em>fai2</em><em>,</em><em></em>) &#8211; Second point&#8217;s coordinate (latitude, longitude) (unit: degree, -90~90, 0~360)</li>
<li><strong>ch</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Must be character. If ch=&#8217;angle&#8217;, then return the geocentric angle (unit: radian) to angle_dis_result. If ch=&#8217;distance&#8217;, then return the corresponding Earth&#8217;s surface distance (unit: meter) to angle_dis_result.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">radian) or corresponding Earth&#8217;s surface distance (unit: meter).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">angle_dis_result (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a>), Geocentric angle (unit</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The formula used here (see below for detail) is the same as used in <a class="reference internal" href="#PyWFL.geophysics.sphere_len" title="PyWFL.geophysics.sphere_len"><code class="xref py py-func docutils literal"><span class="pre">sphere_len()</span></code></a>, but with the different formal.</p>
<div class="math">
\[\cos(\phi)=\cos(\theta_{1})\cos(\theta_{2})+sin(\theta_{1})sin(\theta_{2})\cos(\lambda_{1}-\lambda_{2})\]</div>
<p><span class="math">\(\phi\)</span> is geocentric angle between two points, and <span class="math">\(\theta_{1}\)</span>,:math:<cite>theta_{2}</cite> are colatitude of <span class="math">\(\phi_{1}\)</span> and <span class="math">\(\phi_{2}\)</span> respectively. The Earth&#8217;s radius adopted here is 6371012m.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">angle_dis</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">)</span> <span class="c1"># 0.0349065850399</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle_dis</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">ch</span><span class="o">=</span><span class="s1">&#39;distance&#39;</span><span class="p">)</span> <span class="c1"># 222390.272168</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.area">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">area</code><span class="sig-paren">(</span><em>dlon</em>, <em>lat1</em>, <em>lat2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#area"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.area" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the grid area of the Earth&#8217;s surface</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dlon</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Longitude interval (or length) of the grid (unit: degree)</li>
<li><strong>lat1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Co-latitude of northern grid border (0 represents Northern Pole, and 180  represents Southern Pole, unit: degree)</li>
<li><strong>lat2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Co-latitude of southern grid border (lat2&gt;lat1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Area of grid at the Earth&#8217;s surface (unit: m**2)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
\[ds=r^2 \sin( \theta )d( \theta )d(\lambda)\]</div>
<p class="rubric">Examples</p>
<p>todo</p>
<dl class="docutils">
<dt>See Also</dt>
<dd>todo</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.atg">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">atg</code><span class="sig-paren">(</span><em>s</em>, <em>t</em>, <em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#atg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.atg" title="Permalink to this definition">¶</a></dt>
<dd><p>Get adiabatic temperature gradient or adiabatic lapse rate.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; salinity (unit: psu)</li>
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; temperature (unit: deg Celsius)</li>
<li><strong>p0</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; pressure level (unit: Pascal)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">atg,adiabatic temperature gradient (unit: deg Celsius/decibars).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The adiabatic lapse rate <span class="math">\(\Gamma(s,t,p)\)</span> (deg Celsius/decibar) is defined as the change of temperature per unit pressure for an adiabatic change of pressure of an element of seawater. It&#8217;s assumed that no heat or salt is exchanged with the surroundings so that the pressure change is both adiabatic and isentropic. From thermodynamic considerations, the adiabatic lapse rate <span class="math">\(\Gamma\)</span>, a function of pressure, temperature and salinity can be expressed as</p>
<div class="math">
\[\Gamma(s,t,p) = T \left( \partial V / \partial t \right) / C_{p}\]</div>
<p>where <span class="math">\(T=t+273.15\)</span> is absolute temperature (Kelvin), ( <span class="math">\(\partial V / \partial t\)</span> ) (m3/(kg deg Celsius) ) is thermal expansion and <span class="math">\(C_{p}\)</span> (J/(kg deg Celsius)) specific heat of seawater at constant pressure.</p>
<p>The lapse rate <span class="math">\(\Gamma\)</span> is positive except at low salinities, temperatures and pressures where <span class="math">\(\partial V / \partial t\)</span> is negative. Typical values in the oceanic range are 1~2*104 deg Celsius/decibar.</p>
<p>Adiabatic lapse rate can be calculated from the equation of state and specific heat (Bryden, 1973) or from direct meansurements.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>BRYDEN,H.,1973,DEEP-SEA RES.,20,401-408</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atg</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">1</span><span class="n">e8</span><span class="p">)</span> <span class="c1"># 0.00032559758</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.cs2cs">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">cs2cs</code><span class="sig-paren">(</span><em>c</em>, <em>s</em>, <em>cha='g2h'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#cs2cs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.cs2cs" title="Permalink to this definition">¶</a></dt>
<dd><p>Change geopotential spherical harmonic coefficients to equivalent water height spherical harmonic coefficients or vice versa</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; c(0:n, 0:n) The spherical harmonic coefficients for geopotential (unit:m? corresponding to geoid height?) or equivalent water height (unit: m)</li>
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; s(0:n, 0:n) The spherical harmonic coefficients for geopotential (unit:m? corresponding to geoid height?) or equivalent water height (unit: m)</li>
<li><strong>cha</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; should be in [&#8216;g2h&#8217;, &#8216;h2g&#8217;], default g2h, which means change geopotential spherical harmonic coefficients to equivalent water height spherical harmonic coefficients, if cha=&#8217;h2g&#8217;, then convert the equivalent water height spherical harmonic coefficients to geopotential spherical harmonic coefficients</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>c (array)</li>
<li>s (array)</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>here we get the spherical harmonic coefficient as expansion of:</p>
<blockquote>
<div><div class="math">
\[dh = \sum\sum\left\{ P_{lm}\left(\cos \theta \right) \left[ C_{lm}\cos(m \phi) + S_{lm}\sin(m \phi) \right ] \right \}\]</div>
</div></blockquote>
<p>which is different with surface density defined by Wahr, 1998. The difference is the factor earth semi-radius and water density.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Wahr J.,M. Molenaar, F. Bryan, Time variablity of the Earth&#8217;s gravity field: Hydrological and oceanic effects and their possible detection using GRACE, J. Geophys. Res. Vol.103, No.b12, P30205-30229,1998.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.cs2kai">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">cs2kai</code><span class="sig-paren">(</span><em>cs</em>, <em>cha='x'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#cs2kai"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.cs2kai" title="Permalink to this definition">¶</a></dt>
<dd><p>Change degree 2 spherical harmonic (Stokes) coefficients of the gravity field (C20,C21,S21) to polar motion and length of day (LOD) domain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cs</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; One of the degree 2 spherical harmonic (Stokes) coefficients of the gravity field (C20 or C21 or S21)  (cs is fully normalized spherical harmonic coefficients, like get from FUNC_EXP_FFT)</li>
<li><strong>cha</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; cha is one of follow character, &#8216;x&#8217;, &#8216;y&#8217;, &#8216;z&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Polar Motion (unit: mas) or Length of Day (unit: ms)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>the transfer pairs are (C20, LOD), (C21, POLAR MOTION X),(S21, POLAR MOTION Y), and only mass term suit to use this function.
mas=milli-arcsencod, ms=millisecond</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Yan Haoming, The role of ocean in Earth&#8217;s Rotation and Gravity field, Doctor thesis, Wuhan, 2005.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>todo</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">kai2cs</p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.cs2vertical">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">cs2vertical</code><span class="sig-paren">(</span><em>c</em>, <em>s</em>, <em>depart_lon=-1</em>, <em>alat=None</em>, <em>water_density=1000.0</em>, <em>frame='ce'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#cs2vertical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.cs2vertical" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.degree_var">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">degree_var</code><span class="sig-paren">(</span><em>c</em>, <em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#degree_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.degree_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Get degree variance from spherical harmonic coefficients</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>c</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; c(0:n,0:n) Spherical harmonic coefficients (coefficients for cosine term)</li>
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; s(0:n,0:n) Spherical harmonic coefficients (coefficients for sine term)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">degvar(0:n) Degree variance</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
\[degvar(n)=\sum(c(n,m)^2+s(n,m)^2) \qquad m=0,1,2,....,n \quad n=0,1,2, \dots, N\]</div>
<p>where <span class="math">\(N\)</span> the maximum degree</p>
<p class="rubric">Examples</p>
<p>todo</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">todo</p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.depth2pressure">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">depth2pressure</code><span class="sig-paren">(</span><em>depth</em>, <em>lat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#depth2pressure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.depth2pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>convert ocean depth to pressure</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>depth</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; ocean depth (unit: meter)</li>
<li><strong>lat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; latitude in degree unit (:math:<a href="#id5"><span class="problematic" id="id6">`</span></a>-90^{circ} - 90^{circ})</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ocean Pressure (unit: Pa).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This pressure is gauge pressure under 1 atmospheric pressure, which means pressure=0 at sea surface</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Saunders, &#8220;Practical Conversion of Pressure to Depth&#8221;, J. Phys. Oceanog., April 1981.</td></tr>
</tbody>
</table>
<p>Examples:</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.dm2lod">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">dm2lod</code><span class="sig-paren">(</span><em>dm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#dm2lod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.dm2lod" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate global mass change effect on the length of day (LOD) change</p>
<dl class="docutils">
<dt>Arg:</dt>
<dd>dm (float) : gloabl mass change (unit: kg)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">global mass balance effect on LOD change (unit: ms)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Yan H., and B. Chao, Global mass balance effect on Earth&#8217;s rotation rate, Geophys. Res. Lett., 2010</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.eaam_xyz_j2j3">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">eaam_xyz_j2j3</code><span class="sig-paren">(</span><em>ltrop</em>, <em>slp</em>, <em>pl</em>, <em>u</em>, <em>v</em>, <em>z</em>, <em>hm</em>, <em>method</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#eaam_xyz_j2j3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.eaam_xyz_j2j3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.eaam_xyz_slp">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">eaam_xyz_slp</code><span class="sig-paren">(</span><em>slp</em>, <em>hm</em>, <em>is_sp=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#eaam_xyz_slp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.eaam_xyz_slp" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>slp</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; slp[lon, lat], Sea level pressure/surface pressure. Sea level pressure if is_sp is not presented. Surface pressure if is_sp is presented, and is_sp==.true.   (North-&gt;South) (unit: mbar. Note: 1mbar==1hPa)</li>
<li><strong>hm</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; hm[lon, lat], Topography data or elevation at each points (North-&gt;South) (unit: m)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>fp (array) : [lon, lat], Mass term for equatorial component with IB-hypothesis.(unit:10-7)</li>
<li>fpn (array) : [lon, lat], Mass term for equatorial component with non IB-hypothesis. (unit:10-7)</li>
<li>f3p (array) : [lon, lat], Mass term for axial component with IB-hypothesis.(unit:10-7)</li>
<li>f3pn (array) : [lon, lat], Mass term for axial component with non IB-hypothesis.(unit:10-7)</li>
<li>pmn (array) : [lon, lat], Total mass of atmosphere. (non-IB) (unit:1020 g, not kg)</li>
<li>pm (array) : [lon, lat], Total mass of atmosphere. (IB) (unit:1020 g, not kg)</li>
<li>xypn (array) : [lon, lat], Mass center of x and y coordinate (non-IB) (unit: cm)</li>
<li>xyp (array) : [lon, lat], Mass center of x and y coordinate (IB) (unit: cm)</li>
<li>zpn (array) : [lon, lat], Mass center of z coordinate( non-IB) (unit: cm)</li>
<li>zp (array) : [lon, lat], Mass center of z coordinate( IB) (unit: cm)</li>
<li>j2n (array) : [lon, lat], J2 value (non-IB) (unit: 10-10)</li>
<li>j2 (array) : [lon, lat], J2 value (IB) (unit: 10-10)</li>
<li>j3n (array) : [lon, lat], J3 value (non-IB) (unit: 10-10)</li>
<li>j3 (array) : [lon, lat], J3 value (IB) (unit: 10-10)</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Note: The better choose is to use Surface Pressure(SP) as the input but not Sea Level Pressure(SLP). Due to here we only use approximate equation (see below) to calculate SP from SLP, this will cause minor error at high altitude area. Especially, the total mass of atmosphere is not correct when use SLP as input, while it&#8217;s correct when use SP as input. Other outputs are also have minor errors when use SLP as input.</p>
<p>All input data must be sorted from North to South and at the grid center, order of data may like below (longitude, latitude): (1.25,88.75), (3.75,88.75), ...,(358.75,88.75), (1.25,86.25),(3.75,86.25),.....</p>
<p>If the data is at grid lattice not at the grid center, then you can use INTERPOLATE2D and INTERPOLATE3D to interpolate the original field first, then  use the interpolation field in EAAM_XYZ_SLP.</p>
<p>When calculate surface pressure from sea level pressure, we use topography height and an approximate equation like below:
sp=slp*(1-0.0065*h/288.15)**(9.81/(287.04*0.0065))
where sp,slp,h means surface pressure, sea level pressure and topography height. If you want to get more accuracy output, please choose EAAM_XYZ_J2J3, but in this case you must provide geopotential height data as input.</p>
<p>Note: all the parameters about Earth is Eubank&#8217;s value like below:
CC   =7.1236 D44       Earth principal moment of inertia
CCM=7.1236 D44
CA   =0.003664*CC     C - A</p>
<p>Barnes&#8217;s Earth parameter (not used here) :
CC=7.04D44
CCM=7.1236 D44
CA=0.00333*CC</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Barnes R. T. H., Atmospheric angular momentum fluctuations, length of day changes and polar motion, Proc. R. Soc. Lond. A, 387,31-73, 1983.</td></tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.eaam_xyz_wind">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">eaam_xyz_wind</code><span class="sig-paren">(</span><em>ltrop</em>, <em>pl</em>, <em>u</em>, <em>v</em>, <em>slp=None</em>, <em>hm=None</em>, <em>z=None</em>, <em>en=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#eaam_xyz_wind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.eaam_xyz_wind" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Effective Atmospheric Angular Momentum (EAAM), only for wind-term</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ltrop</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Lays great and equal (&gt;=) 10mbar(1000-&gt;10mbar, include 10mbar. Note: 1mbar==1hPa)</li>
<li><strong>pl</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lay], Pressure values in each vertical lay (such as: 1000., 850., 700.,...,30.10.,...) (unit: mbar)</li>
<li><strong>u</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon,lat,lay], East-ward wind velocities at the each levels (North-&gt;South)  (unit: m/s)</li>
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon,lat,lay], North-ward wind velocities at the each levels (North-&gt;South) (unit: m/s)</li>
<li><strong>slp</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon,lat], Sea level pressure (North-&gt;South) (unit: mbar). The slp,hm,and z must be presented at the same time. If they are not presented, then calculate wind term of effective angular momentum using &#8220;BP&#8221; method; otherwise using &#8220;SP&#8221; method to calculate effective angular momentum.</li>
<li><strong>hm</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon,lat], Topography data or elevation at each points (North-&gt;South) (unit: m)</li>
<li><strong>z</strong><strong>[</strong><strong>lon</strong><strong>,</strong><strong>lat</strong><strong>,</strong><strong>lay</strong><strong>]</strong><strong></strong> &#8211; Geo-potential height at each level from 1000mb to top (North-&gt;South)  (unit: m)</li>
<li><strong>en</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; default False, call <a class="reference internal" href="#PyWFL.geophysics.eaam_xyz_wind" title="PyWFL.geophysics.eaam_xyz_wind"><code class="xref py py-func docutils literal"><span class="pre">eaam_xyz_wind()</span></code></a>, True for <code class="xref py py-func docutils literal"><span class="pre">eaam_xyz_wind_en()</span></code></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>fw (array) : [lon,lat], Wind term for equatorial component (total 1000mbar-&gt;top).(unit:10-7)</li>
<li>fwl (array) : [lon,lat], Wind term for equatorial component but in upper troposphere alone(10mbar-&gt;top).(unit:10-7)</li>
<li>f3w (array) : [lon,lat], Wind term for axial component (total 1000mbar-&gt;top).(unit:10-7)</li>
<li>f3wl (array) : [lon,lat], Wind term for axial component but in upper troposphere alone(10mbar-&gt;top).(unit:10-7)</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>All input data must be sorted from North to South and at the grid center, order of data may like below (longitude, latitude): (1.25,88.75), (3.75,88.75), ...,(358.75,88.75), (1.25,86.25),(3.75,86.25),.....</p>
<p>If the data is at grid lattice not at the grid center, then you can use INTERPOLATE2D and INTERPOLATE3D to interpolate the original field first, then  use the interpolation field in EAAM_XYZ_WIND.</p>
<p>Note: all the parameters about Earth is Eubank&#8217;s value like below:
CC   =7.1236 D44       Earth principal moment of inertia
CCM=7.1236 D44
CA   =0.003664*CC     C - A</p>
<p>Barnes&#8217;s Earth parameter (not used here) :
CC=7.04D44
CCM=7.1236 D44
CA=0.00333*CC</p>
<p>When calculate wind term or relative angular momentum, use &#8220;SP&#8221; method which means put the first level (1000mbar) wind as the surface wind in the mountain; use BP method, which do not consider the land surface and calculate all the wind AAM integral from 1000mbar to top.</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Barnes R. T. H., Atmospheric angular momentum fluctuations, length of day changes and polar motion, Proc. R. Soc. Lond. A, 387,31-73, 1983.</td></tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.eaam_xyz_slp" title="PyWFL.geophysics.eaam_xyz_slp"><code class="xref py py-func docutils literal"><span class="pre">eaam_xyz_slp()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.eaam_xyz_j2j3" title="PyWFL.geophysics.eaam_xyz_j2j3"><code class="xref py py-func docutils literal"><span class="pre">eaam_xyz_j2j3()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.ewam_xyz_j2j3" title="PyWFL.geophysics.ewam_xyz_j2j3"><code class="xref py py-func docutils literal"><span class="pre">ewam_xyz_j2j3()</span></code></a>, <code class="xref py py-func docutils literal"><span class="pre">eaam_xyz_wind_en()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.eam2masms">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">eam2masms</code><span class="sig-paren">(</span><em>xin</em>, <em>cha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#eam2masms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.eam2masms" title="Permalink to this definition">¶</a></dt>
<dd><p>Change effective angular momentum(unit: 1.0d-7 rad) to unit mas (for x,y) and ms (for z)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Effective Angular Momentum (unit: 1.0d-7 rad )</li>
<li><strong>cha</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; cha is one of follow character, &#8216;x&#8217;,  &#8216;y&#8217; , &#8216;z&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Polar Motion value (unit: mas) or Length of Day value (unit: ms)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>cha denote X,Y or Z coordinate
This function only used in the Earth&#8217;s Rotation domain, which change Effective Angular Momentum to polar motion (unit: mas) or Length of Day (unit: ms).
mas=milli-arcsencod, ms=millisecond</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id11" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Barnes R. T. H., Atmospheric angular momentum fluctuations, length of day changes and polar motion, Proc. R. Soc. Lond. A, 387,31-73, 1983.</td></tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.eam_barnes2eubanks">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">eam_barnes2eubanks</code><span class="sig-paren">(</span><em>eam</em>, <em>cha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#eam_barnes2eubanks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.eam_barnes2eubanks" title="Permalink to this definition">¶</a></dt>
<dd><p>Change Barnes&#8217;s EAAM, EWAM or EOAM to Eubanks&#8217;s EAAM, EWAM or EOAM</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>eam</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Effective angular Momentum (unit: free)</li>
<li><strong>cha</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; cha eaqual one of follow character, &#8216;xp&#8217;, &#8216;xc&#8217;, &#8216;yp&#8217;, &#8216;yc&#8217; , &#8216;zp&#8217;, &#8216;zc&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">eam_results, Effective Angular Momentum (unit: same as input)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>cha denote X,Y or Z coordinate for pressure (P) and current (C) term
Change Barnes&#8217;s EAAM or EWAM or EOAM to Eubanks&#8217;s EAAM or EWAM or EOAM</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.eam2masms" title="PyWFL.geophysics.eam2masms"><code class="xref py py-func docutils literal"><span class="pre">eam2masms()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.masms2eam" title="PyWFL.geophysics.masms2eam"><code class="xref py py-func docutils literal"><span class="pre">masms2eam()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.am2eam" title="PyWFL.geophysics.am2eam"><code class="xref py py-func docutils literal"><span class="pre">am2eam()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.ewam_xyz_j2j3">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">ewam_xyz_j2j3</code><span class="sig-paren">(</span><em>pre</em>, <em>evp</em>, <em>runoff</em>, <em>hm</em>, <em>grid_status</em>, <em>method='ocean_zero'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#ewam_xyz_j2j3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.ewam_xyz_j2j3" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Effective Water Angular Momentum (EWAM), geocenter, J2 and J3</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pre</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon,lat+1], Global precipitation (North-&gt;South) (unit: mm).  Note, pre, evp and runoff must be with size of (lon,lat+1), if grid_status==&#8217;center&#8217;, you can only use (lon,lat) to store the data; if grid_status==&#8217;lattice&#8217;, then you will use (lon,lat+1) to store the data, and in the inner of subroutine, pre, evp and runoff will be interpolated into grid center values.  When output, the value is centered at (lon,lat) and with unit of cm.</li>
<li><strong>evp</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon,lat+1], Global evaporation (North-&gt;South) (unit: mm). see note above.  When output, the value is centered at (lon,lat) and with unit of cm.</li>
<li><strong>runoff</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a><em>) </em><em></em><em>[</em><em>lon</em><em>,</em><em>lat+1</em><em>]</em><em></em><em>, </em><em>Land runoff</em><em> (</em><em>North-&gt;South</em>) &#8211; mm). see note above. When output, the value is centered at (lon,lat) and with unit of cm.</li>
<li><strong>hm</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon,lat] :Topography data or elevation at each points (unit: m)</li>
<li><strong>grid_status</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; status of the grid format, grid_status is case-insensitive. If grid_status==&#8217;center&#8217;, then the input pre, evp and runoff will be taken as grid center data with size of (lon,lat); if grid_status==&#8217;lattice&#8217;, then the input pre, evp and runoff will be taken as grid lattice data with size of (lon,lat+1) and will be interpolated to the grid center values in the inner of this subroutine .</li>
<li><strong>method</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; If method==&#8217;ocean_zero&#8217;, then the total water change in the ocean are set to 0.0. If others, then the total water change in ocean are defined as  pre(i,j)-runoff_ocean-evp(i,j), where runoff_ocean is  sum of -runoff(i,j) in land divide ocean area, i.e., the mean runoff in the ocean.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>fp (array) : [lon,lat], Mass term for equatorial component with IB-hypothesis.(unit:10e-7). Here IB means total water in the ocean will be averaged as a single layer in the ocean.</li>
<li>fpn (array) : [lon,lat], Mass term for equatorial component with non IB-hypothesis. (unit:10e-7)</li>
<li>f3p (array) : [lon,lat], Mass term for axial component with IB-hypothesis.(unit:10e-7)</li>
<li>f3pn (array) : [lon,lat], Mass term for axial component with non IB-hypothesis.(unit:10e-7)</li>
<li>pmn (array) : [lon,lat], Total mass of atmosphere. (non-IB) (unit:10e20 g, not kg)</li>
<li>pm (array) : [lon,lat], Total mass of atmosphere. (IB) (unit:10e20 g, not kg)</li>
<li>xypn (array) : [lon,lat], Mass center of x and y coordinate (non-IB) (unit: cm)</li>
<li>xyp (array) : [lon,lat], Mass center of x and y coordinate (IB) (unit: cm)</li>
<li>zpn (array) : [lon,lat], Mass center of z coordinate( non-IB) (unit: cm)</li>
<li>zp (array) : [lon,lat], Mass center of z coordinate( IB) (unit: cm)</li>
<li>j2n (array) : [lon,lat], J2 value (non-IB) (unit: 10e-10)</li>
<li>j2 (array) : [lon,lat], J2 value (IB) (unit: 10e-10)</li>
<li>j3n (array) : [lon,lat], J3 value (non-IB) (unit: 10e-10)</li>
<li>j3 (array) : [lon,lat], J3 value (IB) (unit: 10e-10)</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>All input data must be sorted from North to South, order of data may like below (longitude, latitude): (0,90), (1,90), (2,90),...,(359,90), (0,89),(1,89),.....</p>
<p>Note: all the parameters about Earth is Eubank&#8217;s value like below:
CC   =7.1236 D44       Earth principal moment of inertia
CCM=7.1236 D44
CA   =0.003664*CC     C - A</p>
<p>Barnes&#8217;s Earth parameter (not used here) :
CC=7.04D44
CCM=7.1236 D44
CA=0.00333*CC</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Barnes R. T. H., Atmospheric angular momentum fluctuations, length of day changes and polar motion, Proc. R. Soc. Lond. A, 387,31-73, 1983.</td></tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.fan_filter">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">fan_filter</code><span class="sig-paren">(</span><em>nmax</em>, <em>mmax</em>, <em>r_lon</em>, <em>r_lat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#fan_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.fan_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Gaussian Fan filtering weight function in frequency domain which is used to filter spherical harmonic coefficients</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nmax</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Maximum degree number of Gaussian filtering weight function</li>
<li><strong>mmax</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Maximum order number of Gaussian filtering weight function (mmax&lt;=nmax. If mmax&lt;nmax, then all w(i,j)==0.0 for j&gt;mmax)</li>
<li><strong>r_lon</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; r_lon is the filter average radius in longitude direction (unit: meter), which is the distance on the Earth&#8217;s surface at which w has dropped to 1/2 it value at alpha=0 (the distance on the Earth&#8217;s surface = Earth_R*alpha).</li>
<li><strong>r_lat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; r_lat is the filter average radius in latitude direction (unit: meter).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">w[nmax+1, nmax+1], Gaussian filtering weight function in frequency domain which is used to filter spherical harmonic coefficients</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Fan filter is a expansion of subroutine <code class="xref py py-func docutils literal"><span class="pre">gauss_jekeli_fre()</span></code>, which is the product of two <code class="xref py py-func docutils literal"><span class="pre">gauss_jekeli_fre()</span></code> weight in longitude and latitude direction.</p>
<p>Here we use the equations of C. Jekeli. So when you use the equation defined by Wahr J. (1998), note the difference for factor 2*pi. E.G., in Wahr J. (1998), eq.(30) now can omit the factor 2*pi, you can get the same results.</p>
<p>In the frequency domain, the Gaussian filtering weight function can be computed with recursion relations (see Algorithm in <code class="xref py py-func docutils literal"><span class="pre">gauss_jekeli()</span></code> for definition of a):</p>
<blockquote>
<div><div class="math">
\[\begin{split}W_0 &amp; = 1 \\
W_1 &amp; = \frac{1 + e^{-2a}}{1 - e^{-2a}} - \frac{1}{a} \\
W_{n+1} &amp; = -\frac{2n + 1}{a}W_{n} + W_{n-1}\end{split}\]</div>
</div></blockquote>
<p>Now <span class="math">\(W_{ij}\)</span> can be multiplied to the spherical harmonic coefficients calculated from <code class="xref py py-func docutils literal"><span class="pre">fun_exp_fft()</span></code>, and then use <code class="xref py py-func docutils literal"><span class="pre">func_sum_fft()</span></code> to get the Gaussian filtering weighted spherical function value in space domain.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Zhang, Z., B.F. Chao, Y. Lu, and H.Hsu(2009), An effective filtering for GRACE time-variable gravity: Fan filter, Geophys. Res. Lett., 36,L17311, doi:10.1029/2009GL039459.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Jekeli, C., Alternative methods to smooth the Earth&#8217;s gravity field, Rep.327, Dep. of Geod. Sci. and Surv., Ohio State Univ., Columbus,1981.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td>Wahr J.,M. Molenaar, F. Bryan, Time variablity of the Earth&#8217;s gravity field: Hydrological and oceanic effects and their possible detection using GRACE, J. Geophys. Res. Vol.103, No.b12, P30205-30229,1998.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.gauss_grid">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">gauss_grid</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#gauss_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.gauss_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Gauss grid coordinate 192*94 in longitude*latitude</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>gauss_lon (192): Gauss grid longitude coordinate</li>
<li>gauss_lat (94): Gauss grid latitude coordinate</li>
<li>gauss_lat_edges (95): Gauss grid latitude edges coordinate</li>
</ul>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.geo_distance">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">geo_distance</code><span class="sig-paren">(</span><em>phi1</em>, <em>lambda1</em>, <em>phi2</em>, <em>lambda2</em>, <em>ch='angle'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#geo_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.geo_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate geocentric angle (or corresponding Earth&#8217;s surface distance) between two points</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phi1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; First point&#8217;s coordinate latitude, unit: degree, -90~90</li>
<li><strong>lambda1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; First point&#8217;s coordinate longitude, unit: degree, 0~360</li>
<li><strong>phi2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Second point&#8217;s coordinate latitude, unit: degree, -90~90</li>
<li><strong>lambda2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Second point&#8217;s coordinate longitude unit: degree, 0~360</li>
<li><strong>ch</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; default angle, should be in [&#8216;angle&#8217;, &#8216;distance&#8217;], unit radian or meter</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Geocentric angle (unit: radian) or corresponding Earth&#8217;s surface distance (unit: meter).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
\[\cos(\phi) = \cos( \theta_1) * \cos(\theta_2) + \sin(\theta_1) * \sin(\theta_2) * \cos(\lambda_1 - \lambda_2)\]</div>
<p><span class="math">\(\phi\)</span> is geocentric angle between two points, and <span class="math">\(\theta_1\)</span>,:math:<cite>theta_2</cite> are colatitude of <span class="math">\(\phi_1\)</span> and <span class="math">\(\phi_2\)</span> respectively.
The Earth&#8217;s radius adopted here is 6371012m.</p>
<p class="rubric">Examples</p>
<p>todo</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">todo</p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.geocenter">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">geocenter</code><span class="sig-paren">(</span><em>zlat_s</em>, <em>zlat_n</em>, <em>zlon_w</em>, <em>zlon_e</em>, <em>rho</em>, <em>r1</em>, <em>r2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#geocenter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.geocenter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate geocenter variation caused by mass change at a grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>zlat_s</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Latitude of grid&#8217;s southern lattice (unit: degree -90~90)</li>
<li><strong>zlat_n</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Latitude of grid&#8217;s northern lattice (unit: degree -90~90)</li>
<li><strong>zlon_w</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Longitude of grid&#8217;s western lattice (unit: degree 0~360)</li>
<li><strong>zlon_e</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Longitude of grid&#8217;s eastern lattice (unit: degree 0~360)</li>
<li><strong>rho</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Density (unit: kg/m**3)</li>
<li><strong>r1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Radius of calculated volume (lower one or  benchmark) (unit: m),  see comment for details</li>
<li><strong>r2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Radius of calculated volume (higher one or benchmark plus changes) (unit: m),  see comment for details</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>x (float) : Geocenter displacement in x direction (unit: m)</li>
<li>y (float) : Geocenter displacement in y direction (unit: m)</li>
<li>z (float) : Geocenter displacement in z direction (unit: m)</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If r2&gt;r1, it is easy to understand, if r2&lt;r1, it means a geocenter change in opposite direction. Usually, we calculate geocenter from global mass changes, such as from Sea Surface Height (SSH) changes, at this case, we only know the SSH variations or <span class="math">\(\Delta_{ssh}\)</span>. To calculate geocenter variations caused by <span class="math">\(\Delta_{ssh}\)</span> which may be positive or negative, we can define r1 as the Earth&#8217;s average radius Re (r1=Re), and <span class="math">\(r2=Re+\Delta_{ssh}\)</span>. Here, r2 may greater than r1, or r2 may smaller then r1.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.grace_destripe">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">grace_destripe</code><span class="sig-paren">(</span><em>c</em>, <em>s</em>, <em>n</em>, <em>m</em>, <em>segment=3</em>, <em>fit_order=3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#grace_destripe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.grace_destripe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.green">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">green</code><span class="sig-paren">(</span><em>theta</em>, <em>n_max_love</em>, <em>cha='vd'</em>, <em>cha_norm=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#green"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.green" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the GREEN functions for surface vertical/horizontal displacement, geoid, gravity change, tilt change, free air gravity, potential, and stress.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; theta[n], Radial distance away the observed station</li>
<li><strong>n_max_love</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The maximum order of Love number to be used to calculate Green function. If n_max_love&gt;13000, then there is an interpolation be used to get the value of that Love number. Note: the Love number values are in a file named love.prem.13000.dat, which should be located in c:wflcvflib directory, to use WFL_GREEN, you must copy this file in your working dirctory.</li>
<li><strong>cha</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Character to index which Green function can be returned to green_value(n). cha=&#8217;vd&#8217; or &#8216;VD&#8217; , cha=&#8217;hd&#8217; or &#8216;HD&#8217;, cha=&#8217;gc&#8217; or &#8216;GC&#8217;, cha=&#8217;dg&#8217; or &#8216;DG&#8217;, cha=&#8217;ig&#8217; or &#8216;IG&#8217;, cha=&#8217;dig&#8217; or &#8216;DIG&#8217;, cha=&#8217;tc&#8217; or &#8216;TC&#8217;, cha=&#8217;fag&#8217; or &#8216;FAG&#8217;, cha=&#8217;pc&#8217; or &#8216;PC&#8217;, cha=&#8217;sc&#8217; or &#8216;SC&#8217; for Green function of surface Vertical Displacement (VD), surface Horizontal Displacement (HD), Geoid Change (GC), Direct effect of Gravity (DG), Indirect effect of Gravity (IG), Direct + Indirect effect of Gravity (DIG), Tilt Change (TC), Free Air Gravity (FAG), Potential Change (PC), and Stress Change (SC). For more details, please see Comments|Reference.</li>
<li><strong>cha_norm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) &#8211; If True, then the output Green functions will be normalized by different factors. See Algorithm for more details.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">green_value[n]</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>When cha_norm is True, then the green function is normalized by below factor:</dt>
<dd><a href="#id16"><span class="problematic" id="id17">*</span></a>1011*Earth_radius*theta (theta is in radian unit) for &#8216;vd&#8217;, &#8216;hd&#8217; and &#8216;gc&#8217;;
<a href="#id18"><span class="problematic" id="id19">*</span></a>1017*Earth_radius*theta (theta is in radian unit) for &#8216;dg&#8217;, &#8216;ig&#8217;, &#8216;dig&#8217;, and &#8216;fag&#8217;;
<a href="#id20"><span class="problematic" id="id21">*</span></a>1011*(Earth_radius*theta)2 (theta is in radian unit) for &#8216;tc&#8217; and &#8216;sc&#8217;;
<a href="#id22"><span class="problematic" id="id23">*</span></a>108*Earth_radius*theta (theta is in radian unit) for &#8216;pc&#8217;.</dd>
</dl>
<p>All the unit is in kg, m, s, etc.
For &#8216;vd&#8217; and &#8216;hd&#8217;, the equation used outside the summation is Earth_radius/Earth_mass
For &#8216;dg&#8217;,&#8217;ig&#8217;,and &#8216;dig&#8217;, the equation used outside the summation is g/Earth_mass.
Other green functions are not used for me, so do it yourself.
This subroutine is modified from a Fortran77 program provided by Dr. Wang Hansheng.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.green_func_theta">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">green_func_theta</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#green_func_theta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.green_func_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate angle distance (0.1d-4 ~ 179.5) with smaller step to larger step. The output will be used in Green functions calculation.</p>
<dl class="docutils">
<dt>Arg:</dt>
<dd>n (int) : # of output (n should be 452, if you want to get all the values)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">theta[n] angle distance from 0.00001 to 179.5 (unit: degree)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>if input n&lt;=452, the theta[n] will be output; if input n&gt;452, theta[453:]==0.0</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.j2j3">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">j2j3</code><span class="sig-paren">(</span><em>zlat</em>, <em>dlat</em>, <em>dlon</em>, <em>hi</em>, <em>rho=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#j2j3"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.j2j3" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate j2 and j3 at special grid point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>zlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Co-latitude at grid center (unit: degree)</li>
<li><strong>dlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Interval of latitude (or grid length in latitude direction) (unit: degree)</li>
<li><strong>dlon</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Interval of longitude (or grid length in longitude direction) (unit: degree)</li>
<li><strong>hi</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Height variation of mass&#8212;usually use equivalent water height (unit: meter)</li>
<li><strong>rho</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Density of mass&#8211;usually water density (1000kg/m^3)  (unit: kg/m^3)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>dj2 (float) : J2 value</li>
<li>dj3 (float) : J3 value</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>here J2=-C(2,0), and C(2,0) is not fully normalized spherical coefficient, C(2,0)=sqrt(5)*C(2,0)(normalized)</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id24" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Dickey J O, et al., Recent Earth Oblateness variations: Unraveling climate and postglacial rebound effects,  Science, Vol. 298, p1975-1977, 2002.</td></tr>
</tbody>
</table>
<p>Please see supplement material of the above paper for the  Equation to calculate J2.</p>
<p class="rubric">Examples</p>
<p>todo</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">todo</p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.j2j4j6">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">j2j4j6</code><span class="sig-paren">(</span><em>r</em>, <em>gm</em>, <em>omiga</em>, <em>inv_f</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#j2j4j6"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.j2j4j6" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate J2, J4 and J6 from Earth referenced ellipsoid parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Earth&#8217;s equatorial radius (in meter), if input r=0.d0, then substitutes it with value of 6378137m.</li>
<li><strong>gm</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Geocentric gravitational constant (in m**3/s**2), if input gm=0.0d0, then substitutes it with value of 3.986005e+14 m**3/s**2.</li>
<li><strong>omiga</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Earth&#8217;s angular velocity (in Rad/s), if input omig=0.d0, then substitutes it with value of 7.292115D-5 rad/s.</li>
<li><strong>inv_f</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; inverse of Earth&#8217;s flattening (==1/f), if input inv_f=0.d0, then substitutes it with value of 298.257222101.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>j (array) : j(1:3) corresponding with J2, J4 and J6, respectively.</li>
<li>c(array) : c(1:3) corresponding with fully normalized zonal spherical harmonic coefficients C20, C40, and C60, respectively.</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The default input Earth&#8217;s ellipsoid parameters are adopted from IERS 2003 conventions, see &#8220;Table 1.2: Parameters of the Geodetic Reference System GRS80&#8221; for details.</p>
<p>The output values are often used to calculate gravity anomalies from spherical harmonic coefficients geoid modle such as GGM03C, GGM03S, EGM96, and so on.</p>
<dl class="docutils">
<dt>reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id25" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Rapp R. H., A Fortran program for the computation of gravimetric quantities from high degree spherical harmonic expansions, OSU Reports No. 334, 1982.</td></tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.kai2cs">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">kai2cs</code><span class="sig-paren">(</span><em>kai</em>, <em>cha='x'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#kai2cs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.kai2cs" title="Permalink to this definition">¶</a></dt>
<dd><p>Change polar motion and length of day (LOD) domain to degree 2 spherical harmonic (Stokes) coefficients of the gravity field (C20,C21,S21)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>kai</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Polar Motion (unit: mas) or Length of Day (unit: ms)</li>
<li><strong>cha</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; cha is one of follow character, &#8216;x&#8217;, &#8216;y&#8217;, &#8216;z&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">One of the degree 2 spherical harmonic (Stokes) coefficients of the gravity field (C20 or C21 or S21)  (c20,c21,s21 are fully normalized spherical coefficients; the fully normalized (4*pi) Legendre polynomials)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The transfer pairs are (LOD,C20 ), ( POLAR MOTION X,C21),(POLAR MOTION Y, S21), and only mass term are suit to use this function.
mas=milli-arcsencod, ms=millisecond
when convert LOD to c20, we don&#8217;t consider the global mass change (in other words, we set <span class="math">\(\Delta M=0\)</span>)</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id26" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Yan Haoming, The role of ocean in Earth&#8217;s Rotation and Gravity field, Doctor thesis, Wuhan, 2005.</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>todo</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">cs2kai</p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.load_vert_def">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">load_vert_def</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#load_vert_def"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.load_vert_def" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.load_vert_exp">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">load_vert_exp</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#load_vert_exp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.load_vert_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the radial elastic deformation of the Earth&#8217;s surface only estimated from atmospheric surface pressure field globally by experiment method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>p</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; p[nlon,nlat], atmospheric surface pressure field (sorted by latitude (90~-90) first, then sorted by longitude (0~360). e.g. the coordinate of SIGMA should be (0.5,89.5) (1.5, 89.5),....(359.5,89.5) (0.5, 88.5) (1.5, 88.5).......... (359.5, -89.5) for 1x1 P). Unit of  P is Pascal. (Note: in the ocean, P must be set to 0.0d0)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>u[nlon, nlat]: Radial elastic defomation of the Earth&#8217;s surface calculated by using experimental method(unit: mm) (grid mean value) , see comment for details. (Note: only 80N~60S have the values, other areas are 0)</li>
<li>pbar(nlon, nlat): The average pressure for each grid center point (surrounding area of the point is about 2000km wide), unit: Pascal. (Note: only 80N~60S have the values, other areas are 0)</li>
</ul>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p><span class="math">\(u=-0.9*pbar-0.35(p-pbar)\)</span>, here <span class="math">\(pbar\)</span> is the average (surrounding area of the point is 2000km wide) pressure for the point, and  p is the grid point surface pressure. See reference for details. This result is only the experimental value, the more precise value can be get by using LOAD_VERT_DEF.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id27" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Rabbel, W., J. Zschau, Static deformations and gravity changes at the Earth&#8217;s surface due to atmospheric loading, J Geophys., 56, 81-99,1985.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.lod2torque">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">lod2torque</code><span class="sig-paren">(</span><em>dt</em>, <em>lod</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#lod2torque"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.lod2torque" title="Permalink to this definition">¶</a></dt>
<dd><p>Change LOD (length of day)  to torque (z axis)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time interval step of input array</li>
<li><strong>lod</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; lod[n], LOD change (unit: ms)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">torque_lod[n], The corresponding torque in z axis, unit: Hadley, see <a class="reference internal" href="#PyWFL.geophysics.torque" title="PyWFL.geophysics.torque"><code class="xref py py-func docutils literal"><span class="pre">torque()</span></code></a> for details</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>torque_lod(1),torque_lod(n) are interpolated from torque_lod(2) and torque_lod(n-1), respectively.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.love">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">love</code><span class="sig-paren">(</span><em>n</em>, <em>ch='wang'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#love"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.love" title="Permalink to this definition">¶</a></dt>
<dd><p>Get load love number from 0 to n (n&lt;=MAX) by cubic spline interpolation method</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Maximum order of load love. (if n&gt;MAX, then all h(MAX:n),l(MAX:n), and k(MAX:n) will be infinity value, i.e. values of <span class="math">\(h_{\infty}\)</span>, <span class="math">\(l_{\infty}\)</span> and <span class="math">\(k_{\infty}\)</span>)</li>
<li><strong>ch</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; optional in [&#8216;wang&#8217;, &#8216;farrell&#8217;], for &#8216;wang&#8217;, MAX=13000, for &#8216;farrell&#8217;, MAX=10000</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>h (array): h(n), Load love number h</li>
<li>l (array): l(n), Load love number l</li>
<li>k (array): k(n), Load love number k</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id28" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>FARRELL W. E., Reviews of geophysics and space physics, 10,3,761-797, 1972. Table A2.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id29" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Wang Hansheng, etc. New evolve of load love number for SNREI Earth model, Chinese J. Geophys.,vol.36,supp.,182-189,1996 (in Chinese)</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.masms2eam">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">masms2eam</code><span class="sig-paren">(</span><em>xin</em>, <em>cha</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#masms2eam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.masms2eam" title="Permalink to this definition">¶</a></dt>
<dd><p>Change Polar Motion (unit: mas) or Length of Day (unit: ms) to effective angular momentum (unit: 1.0d-7 rad)
:param xin: Polar Motion (unit: mas) or Length of Day (unit: ms)
:type xin: float
:param cha: cha is one of follow character, &#8216;x&#8217;,  &#8216;y&#8217; , &#8216;z&#8217;
:type cha: string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Effective Angular Momentum (unit: 1.0d-7 rad )</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>cha denote X,Y or Z coordinate
This function only used in Earth Rotation domain, which change polar motion or Length of Day to EAM.
mas=milli-arcsencod, ms=millisecond</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id30" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Barnes R. T. H., Atmospheric angular momentum fluctuations, length of day changes and polar motion, Proc. R. Soc. Lond. A, 387,31-73, 1983.</td></tr>
</tbody>
</table>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.mountain_torque">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">mountain_torque</code><span class="sig-paren">(</span><em>sp</em>, <em>hm</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#mountain_torque"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.mountain_torque" title="Permalink to this definition">¶</a></dt>
<dd><p>Using torque method to calculate mountain torques from atmosphere/water to solid Earth</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> &#8211; (lon,lat), surface pressure (unit: Pa) or water height (unit: cm*100 or 0.1mm) (centered grid data) (north-&gt;south direction (N-&gt;S), for 1*1 grid, the coordinate is like (0.5,89.5),(1.5,89.5),(2.5,89.5),.....(359.5,89.5),(0.5,88.5),(1.5,88.5)....)</li>
<li><strong>hm</strong> &#8211; (lon,lat), topography/orography data (unit: m) (centered grid data) (N-&gt;S, for 1*1 grid, the coordinate is like (0.5, 89.5), (1.5, 89.5),...(359.5, 89.5), (0.5, 88.5), (1.5, 88.5)...)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>te : (lon,lat), complex output (x+iy), ellipsoidal torque for IB hypothesis (centered grid data, N-&gt;S) (unit:Hadley, 1HU=10**18kg.m.m/s/s=N.m)</li>
<li>ten : (lon,lat), complex output (x+iy), ellipsoidal torque for NIB hypothesis (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>tm_dp : (lon,lat),  complex output (x+iy), mountain torque for IB hypothesis using pressure gradient method (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>tmn_dp : (lon,lat), complex output (x+iy), mountain torque for NIB hypothesis using pressure gradient method (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>tm_dh : (lon,lat), complex output (x+iy), mountain torque for IB hypothesis using topography gradient method (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>tmn_dh : (lon,lat), complex output (x+iy), mountain torque for NIB hypothesis using topography gradient method (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>tm3_dp : (lon,lat), z component, mountain torque for IB hypothesis using pressure gradient method (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>tm3n_dp : (lon,lat), z component, mountain torque for NIB hypothesis using pressure gradient method (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>tm3_dh : (lon,lat), z component, mountain torque for NIB hypothesis using pressure gradient method (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>tm3n_dh : (lon,lat), z component, mountain torque for NIB hypothesis using topography gradient method (centered grid data, N-&gt;S) (unit:Hadley)</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This is the subset of subroutine <a class="reference internal" href="#PyWFL.geophysics.torque" title="PyWFL.geophysics.torque"><code class="xref py py-func docutils literal"><span class="pre">torque()</span></code></a>, but with centered data input only for surface pressure/water data.
For water height data such as land-water, usually use non-IB results. For surface pressure data, usually use IB results.
For the water data input, if you have water data with cm unit, then you should multiply the water data by 100 as the input SP parameter.</p>
<p>The mountain torque equations in the three Egger B. J. paper are wrong. The mountain torque equation of Schindelegger M. paper is correct</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id31" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Egger B. J. and K. P. Hoinka, Equatorial components of global atmospheric angular momentum: covariance functions, Q. J. R. Meteorol. Soc., Vol. 128, p1137-1157, 2002.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id32" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Egger B. J. and K. P. Hoinka, Mountain torques and the equatorial components of global angular momentum, J. Atmos. Sci., p2319-2331, 2000.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id33" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td>Egger B. J., K. Weickmann, and K. P. Hoinka, Angular momentum in the global atmospheric circulation, Rev. Geophys., Vol. 45, RG4007, 2007.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id34" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td>Schindelegger M., J. Bohm and D. Salstein, Seasonal and intraseasonal polar motion variability as deduced from atmospheric torques, J. Geod. Geoinfor., Vol. 1, P89-95, 2012</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id35" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td>Schindelegger M., D. Salsteim and J. Bohm, Recent estimates of Earth-atmosphere interaction torques and their use in studying polar motion variability, J. Geophys. Res., Vol. 118, p4586-4598, 2013.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id36" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[6]</td><td>Feldstein S. B., The dynamics of atmospherically driven intraseasonal polar motion, J. Atmos. Sci., Vol. 65, P2290-2307,2008.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.oam_int">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">oam_int</code><span class="sig-paren">(</span><em>rho</em>, <em>r1</em>, <em>r2</em>, <em>zlat_s</em>, <em>zlat_n</em>, <em>zlon_w</em>, <em>zlon_e</em>, <em>u</em>, <em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#oam_int"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.oam_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate grid ocean angular momentum use integral calculation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rho</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean water&#8217;s density at grid (unit: kg/m**3)</li>
<li><strong>r1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The distance from Earth center to the grid lower edge in vertical (or z) direction (unit: m)</li>
<li><strong>r2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The distance from Earth center to the grid higher edge in vertical (or z) direction (unit: m) (r1&lt;=r2)</li>
<li><strong>zlat_s</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Latitude of grid&#8217;s southern lattice (unit: degree -90~90) (zlat_s&lt;zlat_n, south-&gt;north)</li>
<li><strong>zlat_n</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Latitude of grid&#8217;s northern lattice (unit: degree -90~90) (zlat_s&lt;zlat_n, south-&gt;north)</li>
<li><strong>zlon_w</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Longitude of grid&#8217;s western lattice (unit: degree 0~360) (zlon_w&lt;zlon_e, west-&gt;east)</li>
<li><strong>zlon_e</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Longitude of grid&#8217;s eastern lattice (unit: degree 0~360) (zlon_w&lt;zlon_e, west-&gt;east)</li>
<li><strong>u</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean current velocity in latitudinal direction (East is positive) (unit: m/s)</li>
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean current velocity in meridional direction (North is positive) (unit: m/s)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>xoamp, yoamp, zoamp (float) Planetary angular momentum (or mass term) in x, y and z direction (unit: kg.m**2/s)</li>
<li>xoamc, yoamc, zoamc (float) Relative angular momentum (or current term) in x,y and z direction (unit: kg.m**2/s)</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p><a class="reference internal" href="#PyWFL.geophysics.oam_int" title="PyWFL.geophysics.oam_int"><code class="xref py py-func docutils literal"><span class="pre">oam_int()</span></code></a> is more accuracy than simple method <a class="reference internal" href="#PyWFL.geophysics.oam_simple" title="PyWFL.geophysics.oam_simple"><code class="xref py py-func docutils literal"><span class="pre">oam_simple()</span></code></a>. If you only provide rho but no u and v, then you can only get mass term; if you only provide u and v but no rho, then you can only get current term; if all provide, you can get all output. If you do not provide rho, u, or v, then set them to 0.0d0.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.oam_simple">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">oam_simple</code><span class="sig-paren">(</span><em>rho</em>, <em>r</em>, <em>zlat</em>, <em>zlon</em>, <em>dlat</em>, <em>dlon</em>, <em>dr</em>, <em>u</em>, <em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#oam_simple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.oam_simple" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate grid ocean angular momentum use simple calculation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rho</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean water&#8217;s density at grid (unit: kg/m**3)</li>
<li><strong>r1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The distance from Earth center to the grid lower edge in vertical (or z) direction (unit: m)</li>
<li><strong>r2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The distance from Earth center to the grid higher edge in vertical (or z) direction (unit: m) (r1&lt;=r2)</li>
<li><strong>zlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Latitude coordinate of grid center (unit: degree -90~90)</li>
<li><strong>zlon</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Longitude coordinate of grid center (unit: degree 0~360)</li>
<li><strong>dlon</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Longitude length (or interval) of grid (unit: degree 0~360)</li>
<li><strong>dr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The z (or vertical) distance of grid (unit: m)</li>
<li><strong>u</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean current velocity in latitudinal direction (East is positive) (unit: m/s)</li>
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean current velocity in meridional direction (North is positive) (unit: m/s)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>xoamp, yoamp, zoamp (float) Planetary angular momentum (or mass term) in x, y and z direction (unit: kg.m**2/s)</li>
<li>xoamc, yoamc, zoamc (float) Relative angular momentum (or current term) in x,y and z direction (unit: kg.m**2/s)</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p><a class="reference internal" href="#PyWFL.geophysics.oam_int" title="PyWFL.geophysics.oam_int"><code class="xref py py-func docutils literal"><span class="pre">oam_int()</span></code></a> is more accuracy than simple method <a class="reference internal" href="#PyWFL.geophysics.oam_simple" title="PyWFL.geophysics.oam_simple"><code class="xref py py-func docutils literal"><span class="pre">oam_simple()</span></code></a>. If you only provide rho but no u and v, then you can only get mass term; if you only provide u and v but no rho, then you can only get current term; if all provide, you can get all output. If you do not provide rho, u, or v, then set them to 0.0d0.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.ocean_densiy">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">ocean_densiy</code><span class="sig-paren">(</span><em>s</em>, <em>c</em>, <em>depth</em>, <em>lat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#ocean_densiy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.ocean_densiy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate ocean water density from ocean depth, salinity and temperature field</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Salinity (unit: psu)</li>
<li><strong>c</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Temperature (unit: degC)</li>
<li><strong>depth</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean depth (unit: m)</li>
<li><strong>lat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Latitude (unit: deg, -90~90). Gravity variation with latitude is considered here.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Ocean water&#8217;s density (unit: kg/m**3)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.pm2xy">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">pm2xy</code><span class="sig-paren">(</span><em>dt</em>, <em>pm</em>, <em>cha='mas'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#pm2xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.pm2xy" title="Permalink to this definition">¶</a></dt>
<dd><p>Change Polar Motion data PMx and PMy to excitation fields chi_x,chi_y</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Time interval of vector (or array) pm (unit: days)</li>
<li><strong>pm</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; pm[n], Polar motion data (complex, real part is x component, image part is y component) (unit: mas==arcsecond/1000. ) (the direction of x is Greenwich and y is 90 west)</li>
<li><strong>cha</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; If cha==&#8217;mas&#8217; or cha==&#8217;MAS&#8217;, then chi_xy has unit of mas; if cha==&#8217;e-7&#8217; or cha==&#8217;E-7&#8217;, then the unit of chi_xy is e-7.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">chi_xy (n), Excitation fields (complex), real and image part is x and y component respectively (unit: mas or e-7) (the direction of chi_x is Greenwich and chi_y is 90 east)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.potential_temperture_to_situ">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">potential_temperture_to_situ</code><span class="sig-paren">(</span><em>s</em>, <em>theta</em>, <em>pressure</em>, <em>reference_pressure=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#potential_temperture_to_situ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.potential_temperture_to_situ" title="Permalink to this definition">¶</a></dt>
<dd><p>convert potential temperature (theta) to in situ temperature (t) in ocean.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; salinity (unit: psu)</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; potential temperature (unit: deg Celsius) at pressure level pr0</li>
<li><strong>pressure</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; in situ pressure level (unit: Pascal)</li>
<li><strong>reference_pressure</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; reference pressure level for potential temperature (unit: Pascal). If not presented, pr0==0, which means the sea surface.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">t, in situ temperature (unit: deg Celsius) at pressure level reference_pressure.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Potential temperature has been defined classically as the temperature an element of seawater would have if raised adiabatically with no change of salinity to atmospheric pressure (or sea surface with reference_pressure==0). More generally, the potential temperature can be defined as the temperature resulting from an adiabatic displacement to a reference pressure pr that may be greater or less than the initial pressure p. The potential temperature <span class="math">\(\theta\)</span> can be computed from the adiabatic lapse rate <span class="math">\(\Gamma\)</span>,</p>
<div class="math">
\[\theta(s, t, p, p_r) = t + \int_{p}^{p_r} \Gamma(s, t^{'}, p)dp^{'}\]</div>
<p>by integration along an adiabat, i.e. <span class="math">\(\partial t^{'}/ \partial p^{'} = \Gamma^{'}\)</span>. The potential temperature can be evaluated by using an empirical formula or by numerical integration of the defining equation.</p>
<p>Here, the potential temperature <span class="math">\(\theta(s, t, p, p_r)\)</span> at reference pressure pr can be computed with sufficient precision using a 4th order Runge-Kutta integration algorithm (Fofonoff, 1977).</p>
<p>The in situ temperature can be calculated by the inversion of the above process of potential temperature calculation.</p>
<p>For the atmosphere, the relation between potential temperature and in situ temperature is very simple, and can be acquired by,</p>
<div class="math">
\[\theta = T(p_r / p)^{0.286}\]</div>
<p>where <span class="math">\(p_r\)</span> is reference pressure level (usually 1000mb), and p is in situ pressure level, and <span class="math">\(T\)</span> is in situ temperature. Note, here, the unit of :math:`  heta` and <span class="math">\(T\)</span> is Kelvin, not deg Celsius.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id37" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Bryden, 1973, polynomial for adiabatic lapse rate ! and runge-kutta 4-th order intergration algorithm.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id38" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Bryden H,1973, deep-sea res., 20, 401-408</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id39" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td>Rofonoff, N., 1977, Deep-sea res., 24, 489-491</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.prem">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">prem</code><span class="sig-paren">(</span><em>n</em>, <em>parameter='density'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#prem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.prem" title="Permalink to this definition">¶</a></dt>
<dd><p>Acquiring PREM parameters (depth, density, mass, gravity acceleration, pressure, and moment of inertia)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The layers of PREM, n must equal 76 here. (n==76)</li>
<li><strong>parameter</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; default density
* &#8216;mass&#8217;, then  prem_out(:,2) output integral of mass of Earth from Earth&#8217;s center to surface (unit: kg)
* &#8216;gravity&#8217;, then prem_out(:,2) output gravity acceleration of Earth in each layer  (unit:m/s**2)
* &#8216;pressure&#8217;, then prem_out(:,2) output pressures of Earth in each layer (unit: Pa)
* &#8216;inertial&#8217;, then  prem_out(:,2) output integral of moment of inertia of Earth from Earth&#8217;s center to surface (unit: kg.m**2)
* &#8216;density&#8217;, then  prem_out(:,2) output density of Earth in each layer (unit: kg/m**3)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">prem_out[n, 2], prem_out[:,0] is the depth of Earth (unit: km), prem_out[:,1] is the other output parameters defined by &#8220;prem_parameter&#8221; optional input parameter.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">2darray</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<dl class="docutils">
<dt>PREM: The isotropic model parameters in the table below are taken from:</dt>
<dd>Dziewonski A.M., Anderson D.L.(1981): Preliminary reference Earth model. Phys. Earth planet. Inter., 25, 297.</dd>
</dl>
<p>Some values, specified in the table II of the paper, which can likely be accurately fitted by cubic splines are left out. Between the given points within each complex block, the parameters are interpolated by means of natural cubic splines. If only one value of a material parameter is specified per a layer, the parameter is assumed constant within the layer. In the input data for complete ray tracing, the values of density are specified only at the interfaces because elsewhere they have no influence upon the high-frequency asymptotics.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.pressure2depth">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">pressure2depth</code><span class="sig-paren">(</span><em>pressure</em>, <em>lat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#pressure2depth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.pressure2depth" title="Permalink to this definition">¶</a></dt>
<dd><p>convert ocean pressure to depth</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pressure</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; ocean pressure (unit: Pa).</li>
<li><strong>lat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; latitude in degree unit (:math:<a href="#id40"><span class="problematic" id="id41">`</span></a>-90^{circ} - 90^{circ})</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">ocean depth (unit: meter)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This pressure is gauge pressure under 1 atmospheric pressure, which means pressure=0 at sea surface</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id42" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Saunders, &#8220;Practical Conversion of Pressure to Depth&#8221;, J. Phys. Oceanog., April 1981.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.prograd2x0">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">prograd2x0</code><span class="sig-paren">(</span><em>a1</em>, <em>fai1</em>, <em>a2</em>, <em>fai2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#prograd2x0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.prograd2x0" title="Permalink to this definition">¶</a></dt>
<dd><p>Change excitation function in Earth&#8217;s rotation domain to prograde and retrograde format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The amplitude of excitation function x1</li>
<li><strong>fai1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The phase of excitation function x1 (unit: degree)</li>
<li><strong>a2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The amplitude of excitation function x2</li>
<li><strong>fai2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The phase of excitation function x2 (unit: degree)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>f1 (float) :The real part for prograde component</li>
<li>f2 (float) :The image part for prograde component</li>
<li>g1 (float) :The real part for retrograde component</li>
<li>g2 (float) :The image part for retrograde component</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.x2prograd" title="PyWFL.geophysics.x2prograd"><code class="xref py py-func docutils literal"><span class="pre">x2prograd()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.prograd2x_0">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">prograd2x_0</code><span class="sig-paren">(</span><em>f1</em>, <em>f2</em>, <em>g1</em>, <em>g2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#prograd2x_0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.prograd2x_0" title="Permalink to this definition">¶</a></dt>
<dd><p>Change prograde and retrograde format to excitation function in Earth&#8217;s rotation domain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The real part for prograde component</li>
<li><strong>f2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The image part for prograde component</li>
<li><strong>g1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The real part for retrograde component</li>
<li><strong>g2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The image part for retrograde component</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>a1 (float) : The amplitude of excitation function x1</li>
<li>fai1 (float) : The phase of excitation function x1 (unit: degree)</li>
<li>a2 (float) : The amplitude of excitation function x2</li>
<li>fai2 (float) : The phase of excitation function x2 (unit: degree)</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.x2prograd" title="PyWFL.geophysics.x2prograd"><code class="xref py py-func docutils literal"><span class="pre">x2prograd()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.prograd2x0" title="PyWFL.geophysics.prograd2x0"><code class="xref py py-func docutils literal"><span class="pre">prograd2x0()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.rm_sp_from_sg">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">rm_sp_from_sg</code><span class="sig-paren">(</span><em>fre</em>, <em>fre_idx</em>, <em>spec_sp</em>, <em>spec_sg</em>, <em>m_order=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#rm_sp_from_sg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.rm_sp_from_sg" title="Permalink to this definition">¶</a></dt>
<dd><p>Removing surface pressure (solar heating tide) form observed super-conductive gravity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fre</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; frequency index of power spectrum</li>
<li><strong>fre_idx</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; fre_idx[2], frequency index for determination of line equation, then using this line equation to do linear interpolation to get all frequency correction coefficients. Using this coefficients to remove solar heating tide from SG power spectrum.</li>
<li><strong>spec_sp</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; Power spectrum of surface pressure at the station.</li>
<li><strong>spec_sg</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; Power spectrum of the super-conductive gravity at the station.</li>
<li><strong>m_order</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; If larger than 0, then use it as the order of polynomial to fit the back ground noise spectrum. If equal to 0, then use BIC criterion to get the best fit order of polynomial fit, and using this best fit order to fit the back ground noise spectrum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">SG power spectrum removed solar heating tide.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.search_resonance">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">search_resonance</code><span class="sig-paren">(</span><em>fre</em>, <em>spec</em>, <em>n_window</em>, <em>q</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#search_resonance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.search_resonance" title="Permalink to this definition">¶</a></dt>
<dd><p>Search resonance response from Super-conduction Gravity (SG) power spectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fre</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; Frequency index for the input power spectrum</li>
<li><strong>spec</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; Power spectrum to be analysised</li>
<li><strong>n_window</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; The parameter &#8220;n_window&#8221; is a very important parameter when computing the resonance parameter &#8220;resonance_parameter&#8221;. You can change it to different value to see the different results. Typically, n_window should small (maybe around 11, both 5 points from the resonance point) for a true resonance.</li>
<li><strong>q</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Quality factor, typical value of 100~400.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Resonance parameter (big value means there is resonance)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id43" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Smylie D. E., J. Hinderer, B. Richter, and B. Ducarme, The porduct spectra of gravity and barometric pressure in Europe, Physics of the Earth and Planetary Interiors, 80, 135-157, 1993. eq. (50-53)</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.sg_multistation">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">sg_multistation</code><span class="sig-paren">(</span><em>alon</em>, <em>alt</em>, <em>sg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#sg_multistation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.sg_multistation" title="Permalink to this definition">¶</a></dt>
<dd><p>Get translational modes (Slichter modes) from multi-station Superconductive Gravimeter (SG) residuals</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>alon</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; alon[n], Longitude coordinates of the corresponding SG stations</li>
<li><strong>alat</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; alat[n], Latitude coordinates of the corresponding SG stations. Note, alon(i), and alat(i) should be the ith station&#8217;s coordinates.</li>
<li><strong>sg</strong> (<em>2darray</em>) &#8211; sg[n, ns], SG residuals time series (n length, n &gt;= 3) at ns stations.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Signals of 3 translational modes from input SG residuals time series (length n, stations ns). sg_out[:,0] for prograde equatorial components, sg_out[:,1] for axial components, and sg_out[:,2] for retrograde equatorial components.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id44" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Courtier, N., et al., Global superconducting gravimeter observations and the search for the translational modes of inner core, Physics of the Earth and Planetary Interiors (PEPI), 117, P3-20, 2000. Eq. (5), (7)</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.situ_temperatrue_to_potential">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">situ_temperatrue_to_potential</code><span class="sig-paren">(</span><em>s</em>, <em>t</em>, <em>pressure</em>, <em>reference_pressure=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#situ_temperatrue_to_potential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.situ_temperatrue_to_potential" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>s</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; salinity (unit: psu)</li>
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; in situ temperature (unit: deg Celsius) at pressure level reference_pressure.</li>
<li><strong>pressure</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; in situ pressure level (unit: Pascal)</li>
<li><strong>reference_pressure</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; reference pressure level for potential temperature (unit: Pascal). If not presented, pr0==0, which means the sea surface.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">potential temperature (unit: deg Celsius) at pressure level pr0</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.potential_temperture_to_situ" title="PyWFL.geophysics.potential_temperture_to_situ"><code class="xref py py-func docutils literal"><span class="pre">potential_temperture_to_situ()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.soda_xyz_st">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">soda_xyz_st</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#soda_xyz_st"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.soda_xyz_st" title="Permalink to this definition">¶</a></dt>
<dd><p>Get x, y and z coordinate of SODA ocean model for salinity and temperature field</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li>x360 (360): x coordinate (or longitude) (unit: degree 0~360)</li>
<li>y128 (128): y coordinate (or latitude) (unit: degree -60~60)</li>
<li>yedges (129): y coordinate edges (unit: degree -60~60)</li>
<li>z20 (20): z coordinate (or depth) (unit: m)</li>
<li>zedges (21): z coordinate edges (unit: m)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.soda_xyz_uvh">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">soda_xyz_uvh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#soda_xyz_uvh"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.soda_xyz_uvh" title="Permalink to this definition">¶</a></dt>
<dd><p>Get x, y and z coordinate of SODA ocean model for oceanic current u,v and SSH field</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li>uvhx (360) :x coordinate (or longitude) (unit: degree 0~360)</li>
<li>uvhy (128) :y coordinate (or latitude) (unit: degree -60~60)</li>
<li>uvhyedges (129) :y coordinate edges (unit: degree -60~60)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.soiltemp">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">soiltemp</code><span class="sig-paren">(</span><em>amp</em>, <em>period</em>, <em>phase</em>, <em>average_t</em>, <em>depth</em>, <em>year_begin</em>, <em>nday</em>, <em>td=1</em>, <em>unit='day'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#soiltemp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.soiltemp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get soil temperature at given depth from surface temperature</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Amplitude of surface temperature for given period (amp unit: degree)</li>
<li><strong>period</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; period of surface temperature, period&gt;2day. (unit: day or hour, see optional parameter unit for details)</li>
<li><strong>phase</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; initial phase of the surface temperature (unit: degree). The amp and phase can be accquired from surface temperature time series by using subroutine <code class="xref py py-func docutils literal"><span class="pre">harmonic()</span></code>. The phase definition is the same as in <code class="xref py py-func docutils literal"><span class="pre">harmonic()</span></code>.</li>
<li><strong>average_t</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Multiyear average temperature of surface temperature (unit: degree)</li>
<li><strong>depth</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; the depth of soil, depth&gt;0 (unit: mm)</li>
<li><strong>year_begin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the begin year for output, the time index of first output is Jan 1, year_begin.</li>
<li><strong>nday</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; unit of input optional parameter unit (days or hours) from the firs time index</li>
<li><strong>TD</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Thermal Diffusivity. If not presented, the default value is TD=1mm**2/s   (unit: mm**2/s)</li>
<li><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Unit of output time index, default is &#8220;day&#8221;. If not presented or presented and unit=&#8217;day&#8217; (case-insensitive), then the unit of output time index interval is day. If presented and unit=&#8217;hour&#8217; (case-insensitive), then output time index interval is hour. For annual, semi-annual period, and period&gt;2days, you can use unit &#8216;day&#8217;. For diurnal, semi-diurnal and period&gt;2 hours, you can use unit &#8216;hour&#8217;. The output year and MJD index is in unit year and day with suitable decimals and intervals in day or hour.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">soil_t(nday,3) soil_t[:,0] time index (year); soil_t[:,1] time index (MJD); soil_t[:,2] soil temperature at given depth (unit: degree)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id45" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Yan H., W. Chen, Y. Zhu, G. Liu, and M. Zhong, thermal expansion effect on GPS height change, 2009.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.solar_heat_tide">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">solar_heat_tide</code><span class="sig-paren">(</span><em>fre</em>, <em>spec</em>, <em>index_fre</em>, <em>n_window</em>, <em>q</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#solar_heat_tide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.solar_heat_tide" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove solar heating tides effects from Super-conduction Gravity (SG) power spectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fre</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; fre[n], Frequency index for the input power spectrum</li>
<li><strong>spec</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; spec[n], Power spectrum to be analysised</li>
<li><strong>index_fre</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; index_fre[m], Integer number position of the above solar heating tides frequency in fre(n), e.g. index_fre(1)=83, means fre(83)=1/24 cycle/hr. Note, index_fre(1)&gt;3*n_window/2 , index_fre(m) &lt; n-3*n_window/2 . Also note, index_fre(:) must be monotonic.</li>
<li><strong>n_window</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; Window width (must be odd) for removing the solar heating tides effect. e.g. n_window=25, means there are 25/2 points on both side of fre( index_fre(1) ) will be removed, respectively. Note, n_window &lt; n</li>
<li><strong>Q</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Quality factor, typical value of 100~400.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">spec_out[n], Power spectrum which the solar heat tides had been removed from the input spec.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The effects of removing solar heat tides is limited. This is NOT the best method to remove solar heat tides.</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd>..[1] Smylie D. E., J. Hinderer, B. Richter, and B. Ducarme, The porduct spectra of gravity and barometric pressure in Europe, Physics of the Earth and Planetary Interiors, 80, 135-157, 1993. eq. (47-49)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.sphere_len">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">sphere_len</code><span class="sig-paren">(</span><em>b1</em>, <em>l1</em>, <em>b2</em>, <em>l2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#sphere_len"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.sphere_len" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate spherical length (or distance) between point a1(b1,l1) and a2(b2,l2) on Earth&#8217;s surface</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>l1</strong> (<em>b1</em><em>,</em><em></em>) &#8211; First point&#8217;s coordinate (latitude, longitude) (unit: degree, -90~90, 0~360)</li>
<li><strong>l2</strong> (<em>b2</em><em>,</em><em></em>) &#8211; Second point&#8217;s coordinate (latitude, longitude) (unit: degree, -90~90, 0~360)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">slen, Spherical length (or distance) between two points on Earth&#8217;s surface (unit: km )</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The formula used here (see below for detail) is the same as used in ANGLE_DIS, but the different formal.</p>
<div class="math">
\[[\sin(\phi/2)]^{2}=\sin((\phi_{1}-\phi_{2})/2)^{2}+\cos(\phi_{1})\cos(\phi_{2}) [\sin((\lambda_{1}-\lambda_{2})/2)]^{2}\]</div>
<p><span class="math">\(\phi\)</span> is geocentric angle between two points, and (<span class="math">\(\phi_{1}, \lambda_{1}\)</span>) and (<span class="math">\(\phi_{2}, \lambda_{2}\)</span>) are (latitude,longitude) of two points respectively.  The Earth&#8217;s radius adopted here is 6371.012km.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.sphere_len_inv">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">sphere_len_inv</code><span class="sig-paren">(</span><em>b</em>, <em>l</em>, <em>slen_bn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#sphere_len_inv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.sphere_len_inv" title="Permalink to this definition">¶</a></dt>
<dd><p>Give a point and spherical length depart form the point, calculate increase (or decrease) in latitude and longitude</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>l</strong> (<em>b</em><em>,</em><em></em>) &#8211; First point&#8217;s coordinate (latitude, longitude) (unit: degree, -90~90, 0~360)</li>
<li><strong>slen</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Spherical length (or distance) on Earth&#8217;s surface (unit: km )</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">delta_b, delta_l, Increase (or decrease) form first point&#8217;s coordinate (latitude, longitude) (unit: degree, -90~90, 0~360).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Because inverse problem is not unique, so we here only give two special case: 1) delta_b=0, and delta_l come from <a class="reference internal" href="#PyWFL.geophysics.sphere_len_inv" title="PyWFL.geophysics.sphere_len_inv"><code class="xref py py-func docutils literal"><span class="pre">sphere_len_inv()</span></code></a>; 2) delta_l=0 and delta_b come from <a class="reference internal" href="#PyWFL.geophysics.sphere_len_inv" title="PyWFL.geophysics.sphere_len_inv"><code class="xref py py-func docutils literal"><span class="pre">sphere_len_inv()</span></code></a>. So in subroutine <a class="reference internal" href="#PyWFL.geophysics.sphere_len_inv" title="PyWFL.geophysics.sphere_len_inv"><code class="xref py py-func docutils literal"><span class="pre">sphere_len_inv()</span></code></a>, we give delta_b and delta_l at the same time, but you must use the two results separately, see example for details.</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd>YAN Haoming, IB response and it&#8217;s effect on Earth&#8217;s rotation</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">slen</span> <span class="o">=</span> <span class="n">sphere_len</span><span class="p">(</span><span class="mi">63</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">slen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">201.893584896</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">sphere_len_inv</span><span class="p">(</span><span class="mi">63</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">slen</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">res</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="mf">1.815669210053464</span><span class="p">,</span> <span class="mf">3.9999999999999996</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">sphere_len</span><span class="p">(</span><span class="mi">63</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># correct use of inverse result</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">201.893584896</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">sphere_len</span><span class="p">(</span><span class="mi">63</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">63</span><span class="o">-</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># correct use of inverse result</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">201.893584896</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">sphere_len</span><span class="p">(</span><span class="mi">63</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">63</span><span class="o">+</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">10</span><span class="o">+</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># misuse !</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">281.02153828</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.stress_torque">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">stress_torque</code><span class="sig-paren">(</span><em>ets</em>, <em>nts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#stress_torque"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.stress_torque" title="Permalink to this definition">¶</a></dt>
<dd><p>Using torque method to calculate stress (both friction and gravity wave) torques from atmosphere to solid Earth</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ETS</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; ETS[lon, lat] : eastward turbulent (or gravity wave) surface stress  (unit: N/m2) (lattice grid data) (N-&gt;S) . If unit is (N m-2 s), then divide the data with the time step of the data. For example, if daily data were used, then divide 3600s*24h=86400s to get unit of N/m2 . Other input parameters is the same as here.</li>
<li><strong>NTS</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; NTS[lon, lat] : northward turbulent (or gravity wave) surface stress (unit: N/m2) (lattice grid data) (N-&gt;S)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>TF[lon, lat]: complex output (x+iy), friction (or gravity wave) torque (centered grid data, N-&gt;S) (unit:Hadley)</li>
<li>TF3[lon, lat]: z component, friction (or gravity wave) torque (centered grid data, N-&gt;S) (unit:Hadley)</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This is the subset of subroutine <a class="reference internal" href="#PyWFL.geophysics.torque" title="PyWFL.geophysics.torque"><code class="xref py py-func docutils literal"><span class="pre">torque()</span></code></a>, but with centered data input only for stress data.</p>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id46" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Egger B. J. and K. P. Hoinka, Equatorial components of global atmospheric angular momentum: covariance functions, Q. J. R. Meteorol. Soc., Vol. 128, p1137-1157, 2002.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id47" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Egger B. J. and K. P. Hoinka, Mountain torques and the equatorial components of global angular momentum, J. Atmos. Sci., p2319-2331, 2000.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id48" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td>Egger B. J., K. Weickmann, and K. P. Hoinka, Angular momentum in the global atmospheric circulation, Rev. Geophys., Vol. 45, RG4007, 2007.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id49" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td>Schindelegger M., J. Bohm and D. Salstein, Seasonal and intraseasonal polar motion variability as deduced from atmospheric torques, J. Geod. Geoinfor., Vol. 1, P89-95, 2012</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id50" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td>Schindelegger M., D. Salsteim and J. Bohm, Recent estimates of Earth-atmosphere interaction torques and their use in studying polar motion variability, J. Geophys. Res., Vol. 118, p4586-4598, 2013.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id51" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[6]</td><td>Feldstein S. B., The dynamics of atmospherically driven intraseasonal polar motion, J. Atmos. Sci., Vol. 65, P2290-2307,2008.</td></tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.mountain_torque" title="PyWFL.geophysics.mountain_torque"><code class="xref py py-func docutils literal"><span class="pre">mountain_torque()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.torque" title="PyWFL.geophysics.torque"><code class="xref py py-func docutils literal"><span class="pre">torque()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.thermal_vertical_deformation">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">thermal_vertical_deformation</code><span class="sig-paren">(</span><em>amp</em>, <em>period</em>, <em>phase</em>, <em>year_begin</em>, <em>nday</em>, <em>pr=0.25</em>, <em>ltec=1.2e-05</em>, <em>td=1</em>, <em>unit='day'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#thermal_vertical_deformation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.thermal_vertical_deformation" title="Permalink to this definition">¶</a></dt>
<dd><p>Using a half-space head conduction model to calculate the vertical change of bed rock</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>amp</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Amplitude of surface temperature for given period (amp unit: degree)</li>
<li><strong>period</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; period of surface temperature, period&gt;2day. (unit: day or hour)</li>
<li><strong>phase</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; initial phase of the surface temperature (unit: degree). The amp and phase can be accquired from surface temperature time series by usingsubroutine HARMONIC. The phase definition is the same as in HARMONIC.</li>
<li><strong>year_begin</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; the begin year for output, the time index of first output is Jan 1, year_begin.</li>
<li><strong>nday</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; unit of input optional parameter unit (days or hours) from the firs time index</li>
<li><strong>pr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Poisson&#8217;s Ratio. If not presented, the default value is PR=0.25</li>
<li><strong>ltec</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Linear Thermal Expansion Coefficient. If not presented, the default value is LTEC=12.D-6  ( or 12*10-6).  (unit: 1/degree)</li>
<li><strong>td</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Thermal Diffusivity. If not presented, the default value is TD=1mm**2/s   (unit: mm**2/s)</li>
<li><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/2/library/string.html#module-string" title="(in Python v2.7)"><em>string</em></a>) &#8211; Unit of output time index, default is &#8220;day&#8221;. If not presented or presented and unit=&#8217;day&#8217; (case-insensitive), then the unit of output time index interval is day. If presented and unit=&#8217;hour&#8217; (case-insensitive), then output time index interval is hour. For annual, semi-annual period, and period&gt;2days, you can use unit &#8216;day&#8217;. For diurnal, semi-diurnal and period&gt;2 hours, you can use unit &#8216;hour&#8217;. The output year and MJD index is in unit year and day with suitable decimals and intervals in day or hour.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dh(nday,3), dh[:,0] time index (year); dh[:,1] time index (MJD); dh[:,2] vertical change of bed rock induced by thermal expansion (unit: mm)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id52" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Yan H., W. Chen, Y. Zhu, G. Liu, and M. Zhong, thermal expansion effect on GPS height change, submitted to .., 2009.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id53" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Dong D., P. Fang, Y. Bock, M. Cheng and S. Miyazaki, 2002, Anatomy of apparent seasonal variations from GPS-derived site position time series, J Geophys Res, Vol. 107, No. B4, 2075, doi:10.1029/2001JB000573</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.torque">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">torque</code><span class="sig-paren">(</span><em>sp</em>, <em>hm</em>, <em>ets</em>, <em>nts</em>, <em>egws</em>, <em>ngws</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#torque"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.torque" title="Permalink to this definition">¶</a></dt>
<dd><p>Using torque method to calculate torques from atmosphere to solid Earth</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sp</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; sp[lat, lon+1], surface pressure (unit: Pa), (lattice grid data) (north-&gt;south direction (N-&gt;S), for 1*1 grid, the coordinate is like (0.,90.),(1.,90.),(2.,90.),.....(359.,90),(0.,89.),(1.,89.)....)</li>
<li><strong>hm</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; hm[lon, lat], topography/orography data (unit: m) (centered grid data) (N-&gt;S, for 1*1 grid, the coordinate is like (0.5, 89.5), (1.5, 89.5),...(359.5, 89.5), (0.5, 88.5), (1.5, 88.5)...)</li>
<li><strong>ets</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon, lat+1], eastward turbulent surface stress (unit: n/m2) (lattice grid data) (n-&gt;s) . if unit is (n m-2 s), then divide the data with the time step of the data. for example, if daily data were used, then divide 3600s*24h=86400s to get unit of n/m2 . other input parameters is the same as here.</li>
<li><strong>nts</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon, lat+1], northward turbulent surface stress (unit: n/m2) (lattice grid data) (n-&gt;s)</li>
<li><strong>egws</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon, lat+1], eastward gravity wave surface stress (unit: n/m2) (lattice grid data) (n-&gt;s)</li>
<li><strong>ngws</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; [lon, lat+1], northward gravity wave surface stress (unit: n/m2) (lattice grid data) (n-&gt;s)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>te (array) : [lon,lat], complex output (x+iy), ellipsoidal torque for ib hypothesis (centered grid data, n-&gt;s) (unit:hadley, 1hu=10**18kg.m.m/s/s=n.m)</li>
<li>ten (array) : [lon,lat], complex output (x+iy), ellipsoidal torque for nib hypothesis (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tm_dp (array) : [lon,lat], complex output (x+iy), mountain torque for ib hypothesis using pressure gradient method (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tmn_dp (array) : [lon,lat], complex output (x+iy), mountain torque for nib hypothesis using pressure gradient method (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tm_dh (array) : [lon,lat], complex output (x+iy), mountain torque for ib hypothesis using topography gradient method (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tmn_dh (array) : [lon,lat], complex output (x+iy), mountain torque for nib hypothesis using topography gradient method (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tf (array) : [lon,lat], complex output (x+iy), friction torque (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tg (array) : [lon,lat], complex output (x+iy), gravity wave torque (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tm3_dp (array) : [lon,lat], z component, mountain torque for ib hypothesis using pressure gradient method (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tm3n_dp (array) : [lon,lat], z component, mountain torque for nib hypothesis using pressure gradient method (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tm3_dh (array) : [lon,lat], z component, mountain torque for ib hypothesis using topography gradient method (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tm3n_dh (array) : [lon,lat], z component, mountain torque for nib hypothesis using topography gradient method (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tf3 (array) : [lon,lat], z component, friction torque (centered grid data, n-&gt;s) (unit:hadley)</li>
<li>tg3 (array) : [lon,lat], z component, gravity wave torque (centered grid data, n-&gt;s) (unit:hadley)</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<table class="docutils footnote" frame="void" id="id54" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><p class="first">Egger B. J. and K. P. Hoinka, Equatorial components of global atmospheric angular momentum: covariance functions, Q. J. R. Meteorol. Soc., Vol. 128, p1137-1157, 2002.</p>
<table class="docutils footnote" frame="void" id="id55" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Egger B. J. and K. P. Hoinka, Mountain torques and the equatorial components of global angular momentum, J. Atmos. Sci., p2319-2331, 2000.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id56" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td>Egger B. J., K. Weickmann, and K. P. Hoinka, Angular momentum in the global atmospheric circulation, Rev. Geophys., Vol. 45, RG4007, 2007.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id57" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td>Schindelegger M., J. Bohm and D. Salstein, Seasonal and intraseasonal polar motion variability as deduced from atmospheric torques, J. Geod. Geoinfor., Vol. 1, P89-95, 2012</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id58" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td>Schindelegger M., D. Salsteim and J. Bohm, Recent estimates of Earth-atmosphere interaction torques and their use in studying polar motion variability, J. Geophys. Res., Vol. 118, p4586-4598, 2013.</td></tr>
</tbody>
</table>
<table class="last docutils footnote" frame="void" id="id59" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[6]</td><td>Feldstein S. B., The dynamics of atmospherically driven intraseasonal polar motion, J. Atmos. Sci., Vol. 65, P2290-2307,2008.</td></tr>
</tbody>
</table>
</td></tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.mountain_torque" title="PyWFL.geophysics.mountain_torque"><code class="xref py py-func docutils literal"><span class="pre">mountain_torque()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.stress_torque" title="PyWFL.geophysics.stress_torque"><code class="xref py py-func docutils literal"><span class="pre">stress_torque()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.eaam_xyz_j2j3" title="PyWFL.geophysics.eaam_xyz_j2j3"><code class="xref py py-func docutils literal"><span class="pre">eaam_xyz_j2j3()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.torque2lod">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">torque2lod</code><span class="sig-paren">(</span><em>dt</em>, <em>torque</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#torque2lod"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.torque2lod" title="Permalink to this definition">¶</a></dt>
<dd><p>Change torque (z axis) to dLOD (length of day)  ( lod(i+1)-lod(i) )</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Time interval (step) of input array, unit: second</li>
<li><strong>torque</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; Torque in z axis, unit: Hadley, see WFL_TORQUE for details</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dlod_torque, The corresponding LOD change from input torque, unit: millisecond, ms. Note, this output is == lod(i+1)-lod(i), NOT  lod(i). To get lod(i), please use subroutine <a class="reference internal" href="#PyWFL.geophysics.torque2lod_adams" title="PyWFL.geophysics.torque2lod_adams"><code class="xref py py-func docutils literal"><span class="pre">torque2lod_adams()</span></code></a>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)">array</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>dlod_torque(1:2) are integrated directly, while dlod_torque(3:n) are integrated by Simpson integral method.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.torque2lod_adams">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">torque2lod_adams</code><span class="sig-paren">(</span><em>dt</em>, <em>torque</em>, <em>lod0</em>, <em>t=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#torque2lod_adams"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.torque2lod_adams" title="Permalink to this definition">¶</a></dt>
<dd><p>Using 4th order Adams-Moulton method to get LOD (length of day) change from torque z</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; time interval (step) of input array, unit: second</li>
<li><strong>torque</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; torque[n], torque in z axis, unit: hadley, see wfl_torque for details</li>
<li><strong>lod</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; lod[3], the first 3 initial values for ordinary differential equation d(lod0)/dt=torque, unit: ms</li>
<li><strong>t</strong> (<a class="reference external" href="https://docs.python.org/2/library/array.html#module-array" title="(in Python v2.7)"><em>array</em></a>) &#8211; t[n], time index of input torque</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><ul class="simple">
<li>lod(n) : the corresponding lod change from input torque, unit: millisecond, ms.</li>
<li>lod_poly(n) :polynomial term of output lod(n). due to numerical integral will cause a polynomial term in the output lod(n) results, we use polynomial fit to remove this polynomial term if you present t and lod_poly at the same time in subroutine wfl_torque2lod_adams.</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#tuple" title="(in Python v2.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.var_reduction">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">var_reduction</code><span class="sig-paren">(</span><em>x</em>, <em>x_correction</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#var_reduction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.var_reduction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.vd_station_index">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">vd_station_index</code><span class="sig-paren">(</span><em>nlat</em>, <em>site_lon</em>, <em>site_lat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#vd_station_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.vd_station_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Get station index for calculation of vertical displacement of special station by using spherical harmonic method. The output of this subroutine will be used by <a class="reference internal" href="#PyWFL.geophysics.load_vert_def" title="PyWFL.geophysics.load_vert_def"><code class="xref py py-func docutils literal"><span class="pre">load_vert_def()</span></code></a> or <a class="reference internal" href="#PyWFL.geophysics.cs2vertical" title="PyWFL.geophysics.cs2vertical"><code class="xref py py-func docutils literal"><span class="pre">cs2vertical()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a>) &#8211; or degree n, is the center grid # in latitude or the maximum degree n of spherical harmonic coefficients</li>
<li><strong>site_lon</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; coordinate longitude (0~360deg) of the station. Unit: degree</li>
<li><strong>site_lat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; coordinate latitude(-90~90deg) of the station. Unit: degree</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>depart_lon, alat[nlat] : see details in subroutine <a class="reference internal" href="#PyWFL.geophysics.cs2vertical" title="PyWFL.geophysics.cs2vertical"><code class="xref py py-func docutils literal"><span class="pre">cs2vertical()</span></code></a>. Unit: degree</li>
<li>idx_lon, idx_lat : Index of the input station location in the output of :func:load_vert_def` or <a class="reference internal" href="#PyWFL.geophysics.cs2vertical" title="PyWFL.geophysics.cs2vertical"><code class="xref py py-func docutils literal"><span class="pre">cs2vertical()</span></code></a>. For example, the output of :func:load_vert_def` or <a class="reference internal" href="#PyWFL.geophysics.cs2vertical" title="PyWFL.geophysics.cs2vertical"><code class="xref py py-func docutils literal"><span class="pre">cs2vertical()</span></code></a> &#8211;&gt; u(idx_lon,idx_lat) is the input station vertical displacement</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If you want to get the vertical deformation of a special GPS station located at (site_lon, site_lat) then do follow:</p>
<p>1.use global atmosphere/hydrology/ocean pressure data (equivalent water height) and <code class="xref py py-func docutils literal"><span class="pre">fun_exp_fft()</span></code> to get spherical harmonic coefficients c and s of the equivalent water heigh;
2. use <a class="reference internal" href="#PyWFL.geophysics.vd_station_index" title="PyWFL.geophysics.vd_station_index"><code class="xref py py-func docutils literal"><span class="pre">vd_station_index()</span></code></a> to get the output parameters of depart_lon, alat, idx_lon, and idx_lat;
3. use <a class="reference internal" href="#PyWFL.geophysics.cs2vertical" title="PyWFL.geophysics.cs2vertical"><code class="xref py py-func docutils literal"><span class="pre">cs2vertical()</span></code></a> with step 2 output parameters to get vertical deformation u, then u(idx_lon,idx_lat) is the vertical deformation of the above GPS station.</p>
<dl class="docutils">
<dt>reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id60" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Mangiarotti, S., A. Cazenave, Annual vertical crustal motions predicted from surface mass redistribution and observed by space geodesy, J Geophys Res, Vol. 106, B3, P4277-4291, 2001.</td></tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.cs2vertical" title="PyWFL.geophysics.cs2vertical"><code class="xref py py-func docutils literal"><span class="pre">cs2vertical()</span></code></a>, <a class="reference internal" href="#PyWFL.geophysics.load_vert_def" title="PyWFL.geophysics.load_vert_def"><code class="xref py py-func docutils literal"><span class="pre">load_vert_def()</span></code></a>, <code class="xref py py-func docutils literal"><span class="pre">func_sum()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">func_sum_fft()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">func_exp()</span></code>, <code class="xref py py-func docutils literal"><span class="pre">func_exp_fft()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.volume">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">volume</code><span class="sig-paren">(</span><em>dlon</em>, <em>lat1</em>, <em>lat2</em>, <em>z1</em>, <em>z2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#volume"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate grid volume of Earth at different oceanic depth or above Earth&#8217;s surface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dlon</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Longitude interval (or length) of the grid (unit: degree)</li>
<li><strong>lat1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Co-latitude of northern grid border (0 is north pole, 180 is south pole, unit: degree)</li>
<li><strong>lat2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Co-latitude of southern grid border (same as lat1, lat2&gt;lat1)</li>
<li><strong>z1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean depth in grid above (positive, unit: m)</li>
<li><strong>z2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Ocean depth in grid bottom (positive, z2&gt;z1, unit: m)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">volume_result, Volume of grid (unit: m**3)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>If calculate mountain volume, then z1 and z2 are negative.</p>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.wind2tao">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">wind2tao</code><span class="sig-paren">(</span><em>windu</em>, <em>windv</em>, <em>air_density=1.3</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#wind2tao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.wind2tao" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>windu</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Wind velocity in East direction (unit: m/s)</li>
<li><strong>windv</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; Wind velocity in North direction (unit: m/s)</li>
<li><strong>air_density</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; air density. Default air_density=1.3km/m3</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><ul class="first last simple">
<li>stressu (float): Wind stress in East direction (unit: kg/(m*s**2) , or N*m-2)</li>
<li>stressv (float): Wind stress in North direction (unit: kg/(m*s**2) , or N*m-2)</li>
</ul>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This function is used for 10m wind in the ocean area.</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id61" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Trenberth, et al. (1990): J. Phys. Oceanogr., 20, 1742-1760. Eq. (2)</td></tr>
</tbody>
</table>
</dd>
</dl>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.windv2tao" title="PyWFL.geophysics.windv2tao"><code class="xref py py-func docutils literal"><span class="pre">windv2tao()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.windv2tao">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">windv2tao</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#windv2tao"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.windv2tao" title="Permalink to this definition">¶</a></dt>
<dd><p>Get wind stress from wind velocity</p>
<dl class="docutils">
<dt>Arg:</dt>
<dd>w (float): Wind velocity (unit: m/s)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tao, Wind stress (unit: kg/(m*s**2) , or N*m-2)</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)">float</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Wind stress tao has the same direction as wind vector W, the input in the above function is absolute value (<span class="math">\(|W|\)</span>) of wind vector W, without consideration of wind direction.</p>
<p>east wind (u) and north wind (v) should be first combine to get W at each grid, after that change <span class="math">\(|W|\)</span> to tao, and then use the direction of W to get tao(u), tao(v).</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><table class="first last docutils footnote" frame="void" id="id62" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Gill A. E., Atmosphere-Ocean Dynamics, Academic press, London, 1982, p29, Eq. (2.4.2)</td></tr>
</tbody>
</table>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">windv2tao</span><span class="p">(</span><span class="mf">4.3</span><span class="p">)</span> <span class="c1"># 0.02542375</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">windv2tao</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># 0.155</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-func docutils literal"><span class="pre">wfl_wind2tao()</span></code></p>
</div>
</dd></dl>

<dl class="function">
<dt id="PyWFL.geophysics.x2prograd">
<code class="descclassname">PyWFL.geophysics.</code><code class="descname">x2prograd</code><span class="sig-paren">(</span><em>a1</em>, <em>fai1</em>, <em>a2</em>, <em>fai2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/PyWFL/geophysics.html#x2prograd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#PyWFL.geophysics.x2prograd" title="Permalink to this definition">¶</a></dt>
<dd><p>Change excitation function in Earth&#8217;s rotation domain to prograde and retrograde format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The amplitude of excitation function x1</li>
<li><strong>fai1</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The phase of excitation function x1 (unit: degree)</li>
<li><strong>a2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The amplitude of excitation function x2</li>
<li><strong>fai2</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; The phase of excitation function x2 (unit: degree)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>tuple</dt>
<dd><p class="first last"><a href="#id63"><span class="problematic" id="id64">*</span></a>a_pro (float): The amplitude for prograde component
<a href="#id65"><span class="problematic" id="id66">*</span></a>fai_pro (float): The phase for prograde component
<a href="#id67"><span class="problematic" id="id68">*</span></a>a_retro (float): The amplitude for retrograde component
<a href="#id69"><span class="problematic" id="id70">*</span></a>fai_retro (float): The phase for retrograde component</p>
</dd>
</dl>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Equation:  change <span class="math">\(x_1 + ix_2 = a_1 \cos(w_t - \phi_1) + i a_2 \cos(w_t - \phi_2)\)</span> to <span class="math">\(a_{pro} \exp(i \phi_{pro}) \exp(i w_t) + a_{retro} \exp(i \phi_{retro}) \exp(-i w_t)\)</span>, here <span class="math">\(x_1\)</span> and <span class="math">\(x_2\)</span> are excitation function used in Earth&#8217;s rotation domain, and <span class="math">\(w\)</span> is angular frequency omega. If the model of <span class="math">\(x_1\)</span> and <span class="math">\(x_2\)</span> are not like above (maybe sine format, see <code class="xref py py-func docutils literal"><span class="pre">harmonic()</span></code> for transfer to the above format in details )</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PyWFL.geophysics.prograd2x0" title="PyWFL.geophysics.prograd2x0"><code class="xref py py-func docutils literal"><span class="pre">prograd2x0()</span></code></a></p>
</div>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="PyWFL.harmonics.html" class="btn btn-neutral float-right" title="PyWFL.harmonics package" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="PyWFL.fit.html" class="btn btn-neutral" title="PyWFL.fit package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, YAN Haoming, WU Dingcheng.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>